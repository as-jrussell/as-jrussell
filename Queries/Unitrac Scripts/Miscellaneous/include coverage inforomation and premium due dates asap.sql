--include coverage inforomation and premium due dates 




SELECT LOAN.NUMBER_TX, OWNER.LAST_NAME_TX, OWNER.FIRST_NAME_TX,OWNER_ADDRESS.LINE_1_TX,OWNER_ADDRESS.CITY_TX,OWNER_ADDRESS.STATE_PROV_TX,OWNER_ADDRESS.POSTAL_CODE_TX,REQUIRED_COVERAGE.TYPE_CD, REQUIRED_COVERAGE.REQUIRED_AMOUNT_NO,
PAYMENT_AMOUNT_NO, PAYMENT_FREQUENCY_CD, REQUIRED_COVERAGE.*
FROM LOAN
INNER JOIN COLLATERAL ON LOAN.ID = COLLATERAL.LOAN_ID AND COLLATERAL.PURGE_DT IS NULL
INNER JOIN PROPERTY ON COLLATERAL.PROPERTY_ID = PROPERTY.ID AND PROPERTY.PURGE_DT IS NULL
INNER JOIN REQUIRED_COVERAGE ON PROPERTY.ID = REQUIRED_COVERAGE.PROPERTY_ID AND REQUIRED_COVERAGE.PURGE_DT IS NULL
INNER JOIN OWNER_LOAN_RELATE ON LOAN.ID = OWNER_LOAN_RELATE.LOAN_ID AND PRIMARY_IN = 'Y' AND OWNER_LOAN_RELATE.PURGE_DT IS NULL
INNER JOIN OWNER ON OWNER_LOAN_RELATE.OWNER_ID = OWNER.ID AND OWNER.PURGE_DT IS NULL
INNER JOIN OWNER_ADDRESS ON PROPERTY.ADDRESS_ID = OWNER_ADDRESS.ID AND OWNER_ADDRESS.PURGE_DT IS NULL
WHERE LOAN.ID in (SELECT ID FROM #tmpLOAN2771) AND OWNER_ADDRESS.STATE_PROV_TX IN ('FL','GA','SC') --AND LOAN.NUMBER_TX = '25627368746'
AND LOAN.PURGE_DT IS NULL