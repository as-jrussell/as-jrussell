USE UniTrac


SELECT TP.EXTERNAL_ID_TX, TP.NAME_TX, RC.DESCRIPTION_TX, 
DELIVERY_TYPE_CD, CU.TO_VALUE_TX, CU.CREATE_DT
  FROM dbo.CHANGE C
LEFT JOIN dbo.CHANGE_UPDATE CU ON C.ID=CU.CHANGE_ID AND C.ENTITY_NAME_TX = 'LDHLib.DeliveryInfo' 
INNER JOIN dbo.DELIVERY_INFO DI ON DI.ID = C.ENTITY_ID AND C.ENTITY_NAME_TX = 'LDHLib.DeliveryInfo' AND CU.QUALIFIER_TX LIKE '%Enable 1st Line of Insurance Processing%'
INNER JOIN dbo.TRADING_PARTNER TP ON TP.ID = DI.TRADING_PARTNER_ID
LEFT JOIN dbo.REF_CODE RC ON RC.CODE_CD = DI.DOCUMENT_TYPE_CD AND RC.DOMAIN_CD = 'DeliveryInfoDocType'
WHERE DI.DELIVERY_TYPE_CD = 'INFORMATICA'




SELECT TP.EXTERNAL_ID_TX, TP.NAME_TX, RC.DESCRIPTION_TX, 
DELIVERY_TYPE_CD, CU.TO_VALUE_TX, CU.CREATE_DT, CU.*
  FROM dbo.CHANGE C
LEFT JOIN dbo.CHANGE_UPDATE CU ON C.ID=CU.CHANGE_ID AND C.ENTITY_NAME_TX = 'LDHLib.DeliveryInfo' 
INNER JOIN dbo.DELIVERY_INFO DI ON DI.ID = C.ENTITY_ID AND C.ENTITY_NAME_TX = 'LDHLib.DeliveryInfo' AND CU.QUALIFIER_TX LIKE '%Enable 1st Line of Insurance Processing%'
INNER JOIN dbo.TRADING_PARTNER TP ON TP.ID = DI.TRADING_PARTNER_ID
LEFT JOIN dbo.REF_CODE RC ON RC.CODE_CD = DI.DOCUMENT_TYPE_CD AND RC.DOMAIN_CD = 'DeliveryInfoDocType'
WHERE DI.DELIVERY_TYPE_CD = 'INFORMATICA' --AND Tp.EXTERNAL_ID_TX = '2468'
AND CU.FROM_VALUE_TX  NOT IN ('N' , '')

SELECT * FROM dbo.PPDATTRIBUTE
WHERE ID = '15790'



SELECT TP.EXTERNAL_ID_TX, TP.NAME_TX, RC.DESCRIPTION_TX, 
DELIVERY_TYPE_CD, P.VALUE_TX, P.CREATE_DT, DI.*
 FROM dbo.PPDATTRIBUTE P
INNER JOIN dbo.PREPROCESSING_DETAIL PD ON PD.ID = P.PREPROCESSING_DETAIL_ID
INNER JOIN dbo.DELIVERY_INFO_GROUP G ON G.ID = PD.DELIVERY_INFO_GROUP_ID
INNER JOIN dbo.DELIVERY_INFO DI ON DI.ID = G.DELIVERY_INFO_ID
INNER JOIN dbo.TRADING_PARTNER TP ON TP.ID = DI.TRADING_PARTNER_ID
LEFT JOIN dbo.REF_CODE RC ON RC.CODE_CD = DI.DOCUMENT_TYPE_CD AND RC.DOMAIN_CD = 'DeliveryInfoDocType'
WHERE DI.DELIVERY_TYPE_CD = 'INFORMATICA' AND P.CODE_CD = 'EnableFirstLineOfInsurance' AND P.VALUE_TX = 'Y'
ORDER BY TP.EXTERNAL_ID_TX ASC 