SELECT * FROM dbo.LENDER
WHERE CODE_TX = '1045'

SELECT  * INTO UniTracHDStorage.dbo.LOAN_1045_1
FROM    dbo.LOAN
WHERE   LENDER_ID IN ( 2047 )
        AND NUMBER_TX IN ( '15962950-01', '20549450-01', '20549250-01',
                           '20549250-01', '20545650-01', '20545650-01',
                           '20545650-01', '20544150-01', '20544150-01',
                           '20543550-01', '20541250-01', '20541250-01',
                           '20540750-01', '20540750-01', '20539150-01',
                           '20537150-01', '20524950-01', '20487950-01',
                           '20450750-01', '20423150-01', '20363050-01',
                           '20323450-01', '20234550-01', '19788350-01',
                           '19774250-01', '19510250-01', '19237850-01',
                           '19100250-01', '19100250-01', '19100250-01',
                           '17257150-01', '15962950-01', '15962950-01',
                           '15922850-01', '15922850-01', '13039050-01',
                           '13039050-01', '12166150-01', '9813730-01',
                           '8563510-01', '8496950-01', '8165460-01',
                           '8165460-01', '7604620-01', '7475010-01',
                           '6195770-01', '6195770-01', '5169060-01',
                           '2927630-01', '2927630-01', '908290-01' )

SELECT * FROM UniTracHDStorage.dbo.LOAN_1045_1



UPDATE  Loan
SET     NUMBER_TX = '515962950' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '15962950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205494501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20549450-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205492501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20549250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205492502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20549250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205456501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20545650-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205456502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20545650-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205456503' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20545650-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205441501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20544150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205441502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20544150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205435501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20543550-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205412501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20541250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205412502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20541250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205407501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20540750-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205407502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20540750-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205391501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20539150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205371502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20537150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '205249501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20524950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '204879501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20487950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '204507501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20450750-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '204231501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20423150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '203630501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20363050-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '203234501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20323450-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '202345501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '20234550-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '197883501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19788350-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '197742501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19774250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '195102501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19510250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '192378501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19237850-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '191002501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19100250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '191002502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19100250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '191002503' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '19100250-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '172571501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '17257150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '159629501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '15962950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '159629502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '15962950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '159228501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '15922850-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '159228502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '15922850-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '130390501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '13039050-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '130390502' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '13039050-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '121661501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '12166150-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '98137301' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '9813730-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '85635101' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '8563510-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '84969501' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '8496950-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '81654601' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '8165460-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '81654602' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '8165460-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '76046201' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '7604620-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '74750101' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '7475010-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '61957701' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '6195770-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '61957702' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '6195770-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '51690601' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '5169060-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '29276301' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '2927630-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '29276302' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '2927630-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '9082901' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'Task37158'
WHERE   NUMBER_TX = '908290-01'
        AND LENDER_ID = 2047
        AND PURGE_DT IS NULL;



--2) INSERT into PROPERTY_CHANGE table
INSERT INTO PROPERTY_CHANGE (ENTITY_NAME_TX,ENTITY_ID,USER_TX,ATTACHMENT_IN,CREATE_DT,AGENCY_ID,DETAILS_IN,FORMATTED_IN,LOCK_ID,PARENT_NAME_TX,PARENT_ID,TRANS_STATUS_CD,UTL_IN)
SELECT 'Allied.UniTrac.Loan',LOAN.ID,'Task37158','N','2016-03-09 00:00:00.000',1,'Y','N',1,'Allied.UniTrac.Loan',LOAN.ID,'PEND','N'
FROM LOAN
WHERE ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1045_1)
--72


--3) INSERT into PROPERTY_CHANGE_UPDATE table
INSERT INTO PROPERTY_CHANGE_UPDATE (CHANGE_ID, TABLE_NAME_TX, TABLE_ID, COLUMN_NM, FROM_VALUE_TX,TO_VALUE_TX,DATATYPE_NO,CREATE_DT,DISPLAY_IN,OPERATION_CD)
select PROPERTY_CHANGE.ID,'LOAN',ENTITY_ID,'NUMBER_TX',UnitracHDStorage.dbo.LOAN_1045_1.NUMBER_TX,LOAN.NUMBER_TX,1,'2016-03-09 00:00:00.000','Y','U'
from PROPERTY_CHANGE
INNER JOIN LOAN ON PROPERTY_CHANGE.ENTITY_ID = LOAN.ID AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
INNER JOIN UnitracHDStorage.dbo.LOAN_1045_1 ON LOAN.ID = UnitracHDStorage.dbo.LOAN_1045_1.ID --AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
WHERE PROPERTY_CHANGE.CREATE_DT = '2016-03-09 00:00:00.000'
AND ENTITY_ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1045_1)
--72

---4) Insert into LOAN_NUMBER Table (Leave old numbers for matching purposes)

INSERT INTO LOAN_NUMBER (LOAN_ID,NUMBER_TX,EFFECTIVE_DT,CREATE_DT,UPDATE_DT,UPDATE_USER_TX, LOCK_ID)
SELECT dbo.LOAN.ID, dbo.LOAN.NUMBER_TX,dbo.LOAN.EFFECTIVE_DT,GETDATE(),GETDATE(),'Task37158',1
FROM UnitracHDStorage.dbo.LOAN_1045_1 HD INNER JOIN dbo.LOAN ON HD.ID = LOAN.ID
--72

--5) Full Text Search Updates

--Create updates
SELECT 'EXEC SaveSearchFullText', PROPERTY.ID 
FROM PROPERTY
INNER JOIN COLLATERAL ON PROPERTY.ID = COLLATERAL.PROPERTY_ID
AND LOAN_ID in (select ID FROM UnitracHDStorage.dbo.LOAN_1045_1)
--74



EXEC SaveSearchFullText	64996653
EXEC SaveSearchFullText	64997188
EXEC SaveSearchFullText	64997204
EXEC SaveSearchFullText	64997230
EXEC SaveSearchFullText	64997918
EXEC SaveSearchFullText	64998124
EXEC SaveSearchFullText	64998807
EXEC SaveSearchFullText	64999910
EXEC SaveSearchFullText	65000205
EXEC SaveSearchFullText	65002289
EXEC SaveSearchFullText	65002457
EXEC SaveSearchFullText	65002484
EXEC SaveSearchFullText	65002656
EXEC SaveSearchFullText	65002658
EXEC SaveSearchFullText	65004139
EXEC SaveSearchFullText	65007546
EXEC SaveSearchFullText	65007662
EXEC SaveSearchFullText	65008148
EXEC SaveSearchFullText	65008397
EXEC SaveSearchFullText	65008406
EXEC SaveSearchFullText	53077569
EXEC SaveSearchFullText	65008900
EXEC SaveSearchFullText	53077491
EXEC SaveSearchFullText	65008959
EXEC SaveSearchFullText	65008961
EXEC SaveSearchFullText	65009001
EXEC SaveSearchFullText	65009020
EXEC SaveSearchFullText	65009031
EXEC SaveSearchFullText	65009032
EXEC SaveSearchFullText	65009033
EXEC SaveSearchFullText	65009034
EXEC SaveSearchFullText	65009036
EXEC SaveSearchFullText	65009039
EXEC SaveSearchFullText	65009041
EXEC SaveSearchFullText	65009052
EXEC SaveSearchFullText	65009069
EXEC SaveSearchFullText	65009094
EXEC SaveSearchFullText	65065999
EXEC SaveSearchFullText	65071378
EXEC SaveSearchFullText	65075201
EXEC SaveSearchFullText	65075335
EXEC SaveSearchFullText	65075344
EXEC SaveSearchFullText	65075348
EXEC SaveSearchFullText	65075350
EXEC SaveSearchFullText	65075353
EXEC SaveSearchFullText	65075354
EXEC SaveSearchFullText	65075357
EXEC SaveSearchFullText	65075362
EXEC SaveSearchFullText	65075364
EXEC SaveSearchFullText	65075397
EXEC SaveSearchFullText	65075399
EXEC SaveSearchFullText	65075411
EXEC SaveSearchFullText	65075437
EXEC SaveSearchFullText	65075439
EXEC SaveSearchFullText	65075447
EXEC SaveSearchFullText	65075452
EXEC SaveSearchFullText	65075453
EXEC SaveSearchFullText	53077569
EXEC SaveSearchFullText	65075455
EXEC SaveSearchFullText	53077491
EXEC SaveSearchFullText	65075470
EXEC SaveSearchFullText	65075488
EXEC SaveSearchFullText	65075502
EXEC SaveSearchFullText	65075509
EXEC SaveSearchFullText	65075522
EXEC SaveSearchFullText	65075524
EXEC SaveSearchFullText	65075538
EXEC SaveSearchFullText	65075560
EXEC SaveSearchFullText	65075575
EXEC SaveSearchFullText	65075594
EXEC SaveSearchFullText	65075621
EXEC SaveSearchFullText	65075632
EXEC SaveSearchFullText	65075656
EXEC SaveSearchFullText	65075668