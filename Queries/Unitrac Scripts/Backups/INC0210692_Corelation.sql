SELECT * --INTO UniTracHDStorage..Loan_1741
FROM dbo.LOAN
WHERE LENDER_ID = '371' AND NUMBER_TX
 IN ('80060560-142',
'80642970-142',
'128592107-142',
'8000936105-142',
'29691101-142',
'80059130-142',
'80091810-142',
'80097930-142',
'80348720-143',
'80574470-142',
'80677470-142',
'80833720-142',
'160095102-142',
'80409300-142',
'80183150-142',
'80237410-145',
'52501109-142',
'70245102-142')


SELECT * FROM UniTracHDStorage..Loan_1741


UPDATE  Loan
SET     NUMBER_TX = '80060560-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80060560-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80642970-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80642970-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '128592107-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '128592107-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '8000936105-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '8000936105-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '29691101-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '29691101-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80059130-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80059130-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80091810-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80091810-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80097930-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80097930-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80348720-4001' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80348720-143'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80574470-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80574470-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80677470-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80677470-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80833720-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80833720-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '160095102-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '160095102-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80409300-3000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80409300-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80183150-3000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80183150-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '80237410-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '80237410-145'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '52501109-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '52501109-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '70245102-4000' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0210692'
WHERE   NUMBER_TX = '70245102-142'
        AND LENDER_ID = '371'
        AND PURGE_DT IS NULL;



--2) INSERT into PROPERTY_CHANGE table
INSERT INTO PROPERTY_CHANGE (ENTITY_NAME_TX,ENTITY_ID,USER_TX,ATTACHMENT_IN,CREATE_DT,AGENCY_ID,DETAILS_IN,FORMATTED_IN,LOCK_ID,PARENT_NAME_TX,PARENT_ID,TRANS_STATUS_CD,UTL_IN)
SELECT 'Allied.UniTrac.Loan',LOAN.ID,'INC0210692','N','2015-11-16 00:00:00.000',1,'Y','N',1,'Allied.UniTrac.Loan',LOAN.ID,'PEND','N'
FROM LOAN
WHERE ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1741)
--36



--3) INSERT into PROPERTY_CHANGE_UPDATE table
INSERT INTO PROPERTY_CHANGE_UPDATE (CHANGE_ID, TABLE_NAME_TX, TABLE_ID, COLUMN_NM, FROM_VALUE_TX,TO_VALUE_TX,DATATYPE_NO,CREATE_DT,DISPLAY_IN,OPERATION_CD)
select PROPERTY_CHANGE.ID,'LOAN',ENTITY_ID,'NUMBER_TX',UnitracHDStorage.dbo.LOAN_1741.NUMBER_TX,LOAN.NUMBER_TX,1,'2015-11-16 00:00:00.000','Y','U'
from PROPERTY_CHANGE
INNER JOIN LOAN ON PROPERTY_CHANGE.ENTITY_ID = LOAN.ID AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
INNER JOIN UnitracHDStorage.dbo.LOAN_1741 ON LOAN.ID = UnitracHDStorage.dbo.LOAN_1741.ID --AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
WHERE PROPERTY_CHANGE.CREATE_DT = '2015-11-16 00:00:00.000'
AND ENTITY_ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1741)
--36

---4) Insert into LOAN_NUMBER Table (Leave old numbers for matching purposes)

INSERT INTO LOAN_NUMBER (LOAN_ID,NUMBER_TX,EFFECTIVE_DT,CREATE_DT,UPDATE_DT,UPDATE_USER_TX, LOCK_ID)
SELECT dbo.LOAN.ID, dbo.LOAN.NUMBER_TX,dbo.LOAN.EFFECTIVE_DT,GETDATE(),GETDATE(),'INC0210692',1
FROM UnitracHDStorage.dbo.LOAN_1741 HD INNER JOIN dbo.LOAN ON HD.ID = LOAN.ID
--36

--5) Full Text Search Updates

--Create updates
SELECT 'EXEC SaveSearchFullText', PROPERTY.ID 
FROM PROPERTY
INNER JOIN COLLATERAL ON PROPERTY.ID = COLLATERAL.PROPERTY_ID
AND LOAN_ID in (select ID FROM UnitracHDStorage.dbo.LOAN_1741)


EXEC SaveSearchFullText	3664114
EXEC SaveSearchFullText	3916682
EXEC SaveSearchFullText	8987792
EXEC SaveSearchFullText	15862344
EXEC SaveSearchFullText	24510593
EXEC SaveSearchFullText	30281699
EXEC SaveSearchFullText	30286022
EXEC SaveSearchFullText	30285967
EXEC SaveSearchFullText	31202504
EXEC SaveSearchFullText	43031647
EXEC SaveSearchFullText	31203719
EXEC SaveSearchFullText	31204244
EXEC SaveSearchFullText	31207928
EXEC SaveSearchFullText	64502166
EXEC SaveSearchFullText	31210429
EXEC SaveSearchFullText	38064066
EXEC SaveSearchFullText	31211533
EXEC SaveSearchFullText	56858941
EXEC SaveSearchFullText	31212369
EXEC SaveSearchFullText	46414824
EXEC SaveSearchFullText	31213591
EXEC SaveSearchFullText	33840263
EXEC SaveSearchFullText	31224777
EXEC SaveSearchFullText	46411611
EXEC SaveSearchFullText	31229464
EXEC SaveSearchFullText	55819414
EXEC SaveSearchFullText	31230292
EXEC SaveSearchFullText	66266985
EXEC SaveSearchFullText	31231117
EXEC SaveSearchFullText	50042045
EXEC SaveSearchFullText	31231320
EXEC SaveSearchFullText	41766502
EXEC SaveSearchFullText	31232125
EXEC SaveSearchFullText	66263934
EXEC SaveSearchFullText	31233517
EXEC SaveSearchFullText	56859220
EXEC SaveSearchFullText	31233670
EXEC SaveSearchFullText	33840263
EXEC SaveSearchFullText	38064066
EXEC SaveSearchFullText	41766502
EXEC SaveSearchFullText	43031647
EXEC SaveSearchFullText	46411611
EXEC SaveSearchFullText	46414824
EXEC SaveSearchFullText	50042045
EXEC SaveSearchFullText	55819414
EXEC SaveSearchFullText	56858941
EXEC SaveSearchFullText	56859220
EXEC SaveSearchFullText	64502166
EXEC SaveSearchFullText	66263934
EXEC SaveSearchFullText	66266985