USE UniTrac



SELECT L.NUMBER_TX [Loan Number], L.PAYMENT_AMOUNT_NO AS [NEW_PAYMENT_AMOUNT_NO]
	,ISNULL(CPA_I.TOTAL_PREMIUM_NO,0) / 12 AS [NEW_INCREASE_AMOUNT_NO],
		CASE 
	WHEN CPQ.PAYMENT_INCREASE_METHOD_CD = 'PR' THEN 
		CASE WHEN ISNULL(CPA_I.REASON_CD, '') = 'R' THEN 
			CASE WHEN FPC.CANCELLATION_DT IS NOT NULL THEN L.ORIGINAL_PAYMENT_AMOUNT_NO + CPA_I.PAYMENT_CHANGE_AMOUNT_NO ELSE L.PAYMENT_AMOUNT_NO END
		ELSE 
			CASE WHEN FPC.CANCELLATION_DT IS NOT NULL THEN L.PAYMENT_AMOUNT_NO ELSE L.PAYMENT_AMOUNT_NO - CPA_I.PAYMENT_CHANGE_AMOUNT_NO END
		END
	ELSE
		CASE WHEN FPC.CANCELLATION_DT IS NOT NULL THEN L.PAYMENT_AMOUNT_NO ELSE L.PAYMENT_AMOUNT_NO - CPA_I.PAYMENT_CHANGE_AMOUNT_NO END
	END AS [CALC_CURRENT_PAYMENT_AMOUNT_NO]
	,FPC.CURRENT_PAYMENT_AMOUNT_NO AS [CURRENT_PAYMENT_AMOUNT_NO]
	,L.ORIGINAL_PAYMENT_AMOUNT_NO AS [ORIGINAL_PAYMENT_AMOUNT_NO],
	ISNULL(CPA_I.TOTAL_PREMIUM_NO,0) AS [CPI_ISSUEDPREMIUM_AMOUNT_NO]
INTO jcs..INC0323277_PaymentIncrease
FROM FORCE_PLACED_CERTIFICATE FPC 
JOIN FORCE_PLACED_CERT_REQUIRED_COVERAGE_RELATE FPCRCR ON FPCRCR.FPC_ID = FPC.ID AND FPCRCR.PURGE_DT IS NULL
JOIN CARRIER CR ON FPC.CARRIER_ID = CR.ID AND CR.PURGE_DT IS NULL	
JOIN REQUIRED_COVERAGE RC ON FPCRCR.REQUIRED_COVERAGE_ID = RC.ID AND RC.PURGE_DT IS NULL					 
JOIN LOAN L ON L.ID = FPC.LOAN_ID AND L.PURGE_DT IS NULL 
JOIN LENDER LND ON LND.ID = L.LENDER_ID AND LND.PURGE_DT IS NULL
JOIN OWNER_LOAN_RELATE OLR ON OLR.LOAN_ID = L.ID AND OLR.PRIMARY_IN = 'Y' AND OLR.PURGE_DT IS NULL
JOIN [OWNER] O ON O.ID = OLR.OWNER_ID AND O.PURGE_DT IS NULL
JOIN PROPERTY P ON RC.PROPERTY_ID = P.ID AND P.PURGE_DT IS NULL											
JOIN COLLATERAL C ON C.LOAN_ID = L.ID AND C.PROPERTY_ID = P.ID AND C.PURGE_DT IS NULL
LEFT JOIN LENDER_ORGANIZATION LO ON L.BRANCH_CODE_TX = LO.CODE_TX AND L.LENDER_ID = LO.LENDER_ID AND LO.TYPE_CD = 'BRCH' AND LO.PURGE_DT IS NULL
LEFT JOIN [ADDRESS] LOPADDR ON LO.PHYSICAL_ADDRESS_ID = LOPADDR.ID AND LOPADDR.PURGE_DT IS NULL
LEFT JOIN [ADDRESS] LOMADDR ON LO.MAILING_ADDRESS_ID = LOMADDR.ID AND LOMADDR.PURGE_DT IS NULL
LEFT JOIN OWNER_ADDRESS AP ON AP.ID = P.ADDRESS_ID AND AP.PURGE_DT IS NULL
LEFT JOIN [OWNER_ADDRESS] AO ON AO.ID = O.ADDRESS_ID AND AO.PURGE_DT IS NULL
LEFT JOIN REF_CODE RC_COVERAGETYPE ON RC_COVERAGETYPE.DOMAIN_CD = 'Coverage' and RC_COVERAGETYPE.CODE_CD = RC.TYPE_CD 
LEFT JOIN REF_CODE RC_DIVISION on RC_DIVISION.DOMAIN_CD = 'ContractType' and RC_DIVISION.CODE_CD = L.DIVISION_CODE_TX 
LEFT JOIN COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID AND CC.PURGE_DT IS NULL
left Join REF_CODE RC_SC on RC_SC.DOMAIN_CD = 'SecondaryClassification' AND CC.SECONDARY_CLASS_CD = RC_SC.CODE_CD
left Join REF_CODE_ATTRIBUTE RCA_PROP on RC_SC.DOMAIN_CD = RCA_PROP.DOMAIN_CD and RC_SC.CODE_CD = RCA_PROP.REF_CD and RCA_PROP.ATTRIBUTE_CD = 'PropertyType'
LEFT JOIN SERVICE_CENTER_FUNCTION_LENDER_RELATE SCR ON SCR.LENDER_ID = LND.ID
LEFT JOIN SERVICE_CENTER_FUNCTION SCF ON SCF.ID = SCR.SERVICE_CENTER_FUNCTION_ID
LEFT JOIN SERVICE_CENTER SC ON SC.ID = SCF.SERVICE_CENTER_ID
LEFT JOIN CPI_QUOTE CPQ ON  CPQ.ID = FPC.CPI_QUOTE_ID AND CPQ.PURGE_DT IS NULL
LEFT JOIN CPI_ACTIVITY CPA_I on CPA_I.CPI_QUOTE_ID = CPQ.ID AND CPA_I.TYPE_CD = 'I'	AND CPA_I.PURGE_DT IS NULL 
WHERE LND.CODE_TX = '1224' AND L.NUMBER_TX IN ( '65393-20', '50426-22', '75011-21', '75011-21' ,
                               '29894-41' ,'68363-20', '51602-20', '66254-21' ,
                               '52484-20' ,'42692-22', '42692-21', '50747-22' ,
                               '63365-20' ,'64949-20', '62204-20', '71288-20' ,
                               '27924-21' ,'56810-21', '51821-20', '59369-20' ,
                               '62708-20' ,'68057-20', '27172-25', '41972-21' ,
                               '66419-20' ,'63257-20', '70718-20', '54089-20' ,
                               '72419-21' ,'64685-20', '63455-20', '64454-20' ,
                               '71702-20' ,'67067-20', '54143-20', '18620-20' ,
                               '56654-21' ,'80399-20', '17788-23', '43352-22' ,
                               '30518-23' ,'67724-20', '67865-20', '48962-20' ,
                               '42389-23' ,'59522-21', '64412-20', '62972-20' ,
                               '48680-20' ,'69779-20', '60167-20', '41672-26' ,
                               '67697-20' ,'50004828-20', '50582-20' ,
                               '50582-20' ,'39473-28', '48854-20', '36626-21' ,
                               '72791-20' ,'23265-25', '56045-20', '64607-21' ,
                               '45935-20' ,'71357-20', '65132-20', '78842-20' ,
                               '35963-23' ,'74582-20', '67811-20', '43253-22' ,
                               '67679-20' ,'70784-20', '71762-20', '13060-27' ,
                               '13060-26' ,'46742-21', '64394-20', '60392-20' ,
                               '69029-20' ,'62276-20', '71882-20', '74783-20' ,
                               '47564-20' ,'70418-20', '73853-20', '64943-21' ,
                               '75920-21' ,'75920-20', '78719-20', '29816-24' ,
                               '47435-21' ,'30774-21', '37388-20', '37178-23' ,
                               '54974-20' ,'54107-20', '53183-20', '5510-21' ,
                               '53300-20' ,'67265-20', '19384-27', '75035-20' ,
                               '73211-20' ,'53849-20', '54539-20', '14606-20' ,
                               '30214-21' ,'52589-20', '74564-20', '66236-20' ,
                               '75575-20' ,'58859-20', '57530-21', '43097-23' ,
                               '63713-20' ,'53897-20', '68495-20', '73442-21' ,
                               '63359-20' ,'41810-25', '70952-20', '70069-20' ,
                               '50051-21' ,'68033-20', '43571-20', '33503-22' ,
                               '30407-29' ,'58175-20', '58175-22', '58175-21' ,
                               '75395-20'
                             )







