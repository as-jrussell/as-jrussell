--DROP TABLE #tmp
SELECT DISTINCT P.LENDER_ID,  LEN(LEGAL_STATUS_CODE_TX) [Length Count]
INTO #tmp
 FROM dbo.COLLATERAL c
JOIN dbo.PROPERTY p ON p.ID = c.PROPERTY_ID
WHERE LEN(LEGAL_STATUS_CODE_TX) > '6'
ORDER BY LEN(LEGAL_STATUS_CODE_TX)    DESC


--DROP TABLE #tmpRR
SELECT DISTINCT LL.CODE_TX, LL.NAME_TX, R.ID, R.DESCRIPTION_TX [Report Name], lrc.DESCRIPTION_TX [Title], T.[Length Count]
INTO #tmpRR
FROM #tmp T
JOIN dbo.LENDER_REPORT_CONFIG LRC ON LRC.LENDER_ID = T.LENDER_ID
JOIN dbo.REPORT_CONFIG RC ON LRC.REPORT_CONFIG_ID = RC.ID
JOIN dbo.REPORT R ON  RC.REPORT_ID = r.ID
JOIN dbo.LENDER LL ON LL.ID = T.LENDER_ID



--DROP TABLE #tmpRH
SELECT DISTINCT R.ID, R.DESCRIPTION_TX INTO #tmpRH
FROM #tmp T
JOIN dbo.LENDER_REPORT_CONFIG LRC ON LRC.LENDER_ID = T.LENDER_ID
JOIN dbo.REPORT_CONFIG RC ON LRC.REPORT_CONFIG_ID = RC.ID
JOIN dbo.REPORT R ON  RC.REPORT_ID = r.ID
JOIN dbo.LENDER LL ON LL.ID = T.LENDER_ID


SELECT * FROM #tmpRH

SELECT * FROM #tmpRR
