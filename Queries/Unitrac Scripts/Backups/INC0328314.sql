USE UniTrac

SELECT * FROM dbo.LENDER_ORGANIZATION
WHERE LENDER_ID = 958

SELECT COUNT(BILLING_STATUS_CD) [Certs billed] FROM dbo.LOAN L
JOIN dbo.FORCE_PLACED_CERTIFICATE FPC ON FPC.LOAN_ID = L.ID
JOIN dbo.DOCUMENT_CONTAINER dc ON DC.RELATE_ID = fpc.ID AND dc.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.ForcePlacedCertificate'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'
AND fpc.BILLING_STATUS_CD = 'BLIT' AND L.DIVISION_CODE_TX = 3
GROUP BY BILLING_STATUS_CD


SELECT COUNT(*) [Certs Mailed] FROM dbo.LOAN L
JOIN dbo.FORCE_PLACED_CERTIFICATE FPC ON FPC.LOAN_ID = L.ID
JOIN dbo.DOCUMENT_CONTAINER dc ON DC.RELATE_ID = fpc.ID AND dc.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.ForcePlacedCertificate'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'  AND L.DIVISION_CODE_TX = 3
GROUP BY DC.RECIPIENT_TYPE_CD



SELECT COUNT(*) [Notices], N.SEQUENCE_NO  FROM dbo.LOAN L
LEFT JOIN dbo.NOTICE N ON N.LOAN_ID = L.ID
LEFT JOIN dbo.DOCUMENT_CONTAINER DC ON DC.RELATE_ID = N.ID AND DC.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.Notice'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'  AND L.DIVISION_CODE_TX = 3
GROUP BY N.SEQUENCE_NO




SELECT COUNT(BILLING_STATUS_CD) [Certs billed] FROM dbo.LOAN L
JOIN dbo.FORCE_PLACED_CERTIFICATE FPC ON FPC.LOAN_ID = L.ID
JOIN dbo.DOCUMENT_CONTAINER dc ON DC.RELATE_ID = fpc.ID AND dc.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.ForcePlacedCertificate'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'
AND fpc.BILLING_STATUS_CD = 'BLIT' AND L.DIVISION_CODE_TX = 4
GROUP BY BILLING_STATUS_CD


SELECT COUNT(*) [Certs Mailed] FROM dbo.LOAN L
JOIN dbo.FORCE_PLACED_CERTIFICATE FPC ON FPC.LOAN_ID = L.ID
JOIN dbo.DOCUMENT_CONTAINER dc ON DC.RELATE_ID = fpc.ID AND dc.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.ForcePlacedCertificate'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'  AND L.DIVISION_CODE_TX = 4
GROUP BY DC.RECIPIENT_TYPE_CD



SELECT COUNT(*) [Notices], N.SEQUENCE_NO [Sequence #]  FROM dbo.LOAN L
LEFT JOIN dbo.NOTICE N ON N.LOAN_ID = L.ID
LEFT JOIN dbo.DOCUMENT_CONTAINER DC ON DC.RELATE_ID = N.ID AND DC.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.Notice'
WHERE L.LENDER_ID = 958 AND DC.UPDATE_DT >= '2017-01-01'
AND L.RECORD_TYPE_CD IN ('G','A') AND DC.RECIPIENT_TYPE_CD= 'BORR'  AND L.DIVISION_CODE_TX = 4
GROUP BY N.SEQUENCE_NO



3	Vehicle Loan
4	Mortgage