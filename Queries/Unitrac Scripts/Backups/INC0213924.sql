SELECT  * --INTO UniTracHDStorage.dbo.LOAN_1075_1
FROM    dbo.LOAN
WHERE   LENDER_ID IN ( 956 )
        AND NUMBER_TX IN ( '20026-4', '20194-1', '304373-2', '305177-2',
                           '306101-2', '306305-2', '306656-2', '3084-1',
                           '311630-3', '312680-2', '314564-4', '315941-2',
                           '315977-2', '316076-2', '317234-2', '318311-3',
                           '321704-4', '322835-2', '323417-2', '324239-1',
                           '6664-2' )

SELECT * FROM UniTracHDStorage.dbo.LOAN_1075_1


--UPDATE  Loan
--SET     NUMBER_TX = '20026-04' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '20026-4'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '220194-01' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '20194-1'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '304373-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '304373-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '305177-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '305177-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '306101-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '306101-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '306305-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '306305-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '306656-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '306656-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '3084-01' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '3084-1'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '311630-03' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '311630-3'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '312680-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '312680-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '314564-04' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '314564-4'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '315941-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '315941-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '315977-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '315977-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '316076-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '316076-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '317234-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '317234-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '318311-03' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '318311-3'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '321704-04' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '321704-4'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '322835-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '322835-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '323417-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '323417-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '324239-01' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '324239-1'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;
--UPDATE  Loan
--SET     NUMBER_TX = '6664-02' ,
--        UPDATE_DT = GETDATE() ,
--        UPDATE_USER_TX = 'INC0213924'
--WHERE   NUMBER_TX = '6664-2'
--        AND LENDER_ID = '956'
--        AND PURGE_DT IS NULL;


--SELECT  * --INTO UniTracHDStorage.dbo.LOAN_1075_1
--FROM    dbo.LOAN
--WHERE   LENDER_ID IN ( 956 )
--        AND NUMBER_TX IN ( '20026-04', '220194-01', '304373-02', '305177-02',
--                           '306101-02', '306305-02', '306656-02', '3084-01',
--                           '311630-03', '312680-02', '314564-04', '315941-02',
--                           '315977-02', '316076-02', '317234-02', '318311-03',
--                           '321704-04', '322835-02', '323417-02', '324239-01',
--                           '6664-02' )


----2) INSERT into PROPERTY_CHANGE table
--INSERT INTO PROPERTY_CHANGE (ENTITY_NAME_TX,ENTITY_ID,USER_TX,ATTACHMENT_IN,CREATE_DT,AGENCY_ID,DETAILS_IN,FORMATTED_IN,LOCK_ID,PARENT_NAME_TX,PARENT_ID,TRANS_STATUS_CD,UTL_IN)
--SELECT 'Allied.UniTrac.Loan',LOAN.ID,'INC0213924','N','2015-12-08 00:00:00.000',1,'Y','N',1,'Allied.UniTrac.Loan',LOAN.ID,'PEND','N'
--FROM LOAN
--WHERE ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1075_1)
----42


----3) INSERT into PROPERTY_CHANGE_UPDATE table
--INSERT INTO PROPERTY_CHANGE_UPDATE (CHANGE_ID, TABLE_NAME_TX, TABLE_ID, COLUMN_NM, FROM_VALUE_TX,TO_VALUE_TX,DATATYPE_NO,CREATE_DT,DISPLAY_IN,OPERATION_CD)
--select PROPERTY_CHANGE.ID,'LOAN',ENTITY_ID,'NUMBER_TX',UnitracHDStorage.dbo.LOAN_1075_1.NUMBER_TX,LOAN.NUMBER_TX,1,'2015-12-08 00:00:00.000','Y','U'
--from PROPERTY_CHANGE
--INNER JOIN LOAN ON PROPERTY_CHANGE.ENTITY_ID = LOAN.ID AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
--INNER JOIN UnitracHDStorage.dbo.LOAN_1075_1 ON LOAN.ID = UnitracHDStorage.dbo.LOAN_1075_1.ID --AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
--WHERE PROPERTY_CHANGE.CREATE_DT = '2015-12-08 00:00:00.000'
--AND ENTITY_ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1075_1)
----0

-----4) Insert into LOAN_NUMBER Table (Leave old numbers for matching purposes)

--INSERT INTO LOAN_NUMBER (LOAN_ID,NUMBER_TX,EFFECTIVE_DT,CREATE_DT,UPDATE_DT,UPDATE_USER_TX, LOCK_ID)
--SELECT dbo.LOAN.ID, dbo.LOAN.NUMBER_TX,dbo.LOAN.EFFECTIVE_DT,GETDATE(),GETDATE(),'INC0213924',1
--FROM UnitracHDStorage.dbo.LOAN_1075_1 HD INNER JOIN dbo.LOAN ON HD.ID = LOAN.ID
----42

----5) Full Text Search Updates

----Create updates
--SELECT 'EXEC SaveSearchFullText', PROPERTY.ID 
--FROM PROPERTY
--INNER JOIN COLLATERAL ON PROPERTY.ID = COLLATERAL.PROPERTY_ID
--AND LOAN_ID in (select ID FROM UnitracHDStorage.dbo.LOAN_1075_1)
----42


--EXEC SaveSearchFullText	5533095
--EXEC SaveSearchFullText	5533161
--EXEC SaveSearchFullText	5547886
--EXEC SaveSearchFullText	5569881
--EXEC SaveSearchFullText	5569892
--EXEC SaveSearchFullText	5606070
--EXEC SaveSearchFullText	5606079
--EXEC SaveSearchFullText	5625529
--EXEC SaveSearchFullText	5643825
--EXEC SaveSearchFullText	5679015
--EXEC SaveSearchFullText	5679092
--EXEC SaveSearchFullText	5679098
--EXEC SaveSearchFullText	6292216
--EXEC SaveSearchFullText	6292220
--EXEC SaveSearchFullText	7570422
--EXEC SaveSearchFullText	7570471
--EXEC SaveSearchFullText	8713525
--EXEC SaveSearchFullText	12160963
--EXEC SaveSearchFullText	13472352
--EXEC SaveSearchFullText	14865746
--EXEC SaveSearchFullText	14865764
--EXEC SaveSearchFullText	14865846
--EXEC SaveSearchFullText	17921494
--EXEC SaveSearchFullText	17921510
--EXEC SaveSearchFullText	17921536
--EXEC SaveSearchFullText	17921569
--EXEC SaveSearchFullText	19455443
--EXEC SaveSearchFullText	19455453
--EXEC SaveSearchFullText	19455457
--EXEC SaveSearchFullText	19455466
--EXEC SaveSearchFullText	19455505
--EXEC SaveSearchFullText	22165849
--EXEC SaveSearchFullText	23436726
--EXEC SaveSearchFullText	23437610
--EXEC SaveSearchFullText	23437626
--EXEC SaveSearchFullText	23437632
--EXEC SaveSearchFullText	23437633
--EXEC SaveSearchFullText	23437645
--EXEC SaveSearchFullText	24920964
--EXEC SaveSearchFullText	24920977
--EXEC SaveSearchFullText	24920978
--EXEC SaveSearchFullText	26882376
--EXEC SaveSearchFullText	26882392

SELECT * FROM dbo.LENDER
WHERE ID IN (244)


--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT DISTINCT BRANCH_CODE_TX, DIVISION_CODE_TX FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.LENDER_ID IN (244) AND DIVISION_CODE_TX = '3'


SELECT * FROM dbo.LENDER
WHERE CODE_TX IN ('2120') 


SELECT  *
FROM    dbo.COLLATERAL_CODE
WHERE   DESCRIPTION_TX LIKE '%%'
        AND AGENCY_ID = '1'
        AND ID IN (  SELECT  COLLATERAL_CODE_ID from LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE --L.LENDER_ID IN (956) AND 
COLLATERAL_CODE_ID IN (13,42) AND  CAST(L.UPDATE_DT AS DATE) = CAST(GETDATE() AS DATE))



SELECT LO.TYPE_CD, LO.CODE_TX , Lo.NAME_TX,*
FROM LENDER L
INNER JOIN LENDER_ORGANIZATION LO ON L.ID = LO.LENDER_ID
INNER JOIN RELATED_DATA RD ON LO.ID = RD.RELATE_ID --AND RD.DEF_ID = '105'
WHERE L.CODE_TX = '2120' AND Lo.TYPE_CD = 'DIV' AND LO.CODE_TX = '3'