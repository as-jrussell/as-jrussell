use unitrac





/*      UPDATE C.COLLATERAL_CODE_ID of 68 and 67 to 525      --This is Veh-OT code of 68 and Veh-A  code of 67 and changed to Vehicle code 525           */

SELECT C.* --into unitrachdstorage..INC0416162_Veh
FROM LOAN L 
INNER JOIN COLLATERAL C ON C.LOAN_ID = L.ID
INNER JOIN LENDER LE ON LE.ID = L.LENDER_ID
INNER JOIN PROPERTY P ON P.ID = C.PROPERTY_ID
INNER JOIN COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
WHERE C.COLLATERAL_CODE_ID IN
(68,67 )
AND LE.CODE_TX = '3035'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND L.RECORD_TYPE_CD <> 'D'
AND P.RECORD_TYPE_CD <> 'D'

update C 
set C.COLLATERAL_CODE_ID = 525, update_dt = GETDATE(), update_user_tx = 'INC0416162', C.LOCK_ID = CASE WHEN C.LOCK_ID >= 255 THEN 1 ELSE C.LOCK_ID + 1 END
from COLLATERAL C
where id in (select id from unitrachdstorage..INC0416162_Veh)


/*UPDATE C.COLLATERAL_CODE_ID of 72 to 8 ----This is changing BT-OT 72 to Boat code of 8   */

SELECT C.*
--into unitrachdstorage..INC0416162_Boat
FROM LOAN L 
INNER JOIN COLLATERAL C ON C.LOAN_ID = L.ID
INNER JOIN LENDER LE ON LE.ID = L.LENDER_ID
INNER JOIN PROPERTY P ON P.ID = C.PROPERTY_ID
INNER JOIN COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
WHERE C.COLLATERAL_CODE_ID IN
(72 )
AND LE.CODE_TX = '3035'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND L.RECORD_TYPE_CD <> 'D'
AND P.RECORD_TYPE_CD <> 'D'

update C 
set C.COLLATERAL_CODE_ID = 72, update_dt = GETDATE(), update_user_tx = 'INC0416162', C.LOCK_ID = CASE WHEN C.LOCK_ID >= 255 THEN 1 ELSE C.LOCK_ID + 1 END
from COLLATERAL C
where id in (select id from unitrachdstorage..INC0416162_Boat)



/*UPDATE C.COLLATERAL_CODE_ID of 70 to 10   ---This is changing RV-OT code of 70 to RV code of 10             */

SELECT C.*
--into unitrachdstorage..INC0416162_RV
 FROM LOAN L 
INNER JOIN COLLATERAL C ON C.LOAN_ID = L.ID
INNER JOIN LENDER LE ON LE.ID = L.LENDER_ID
INNER JOIN PROPERTY P ON P.ID = C.PROPERTY_ID
INNER JOIN COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
WHERE C.COLLATERAL_CODE_ID IN
(70)
AND LE.CODE_TX = '3035'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND L.RECORD_TYPE_CD <> 'D'
AND P.RECORD_TYPE_CD <> 'D'


update C 
set C.COLLATERAL_CODE_ID = 10, update_dt = GETDATE(), update_user_tx = 'INC0416162', C.LOCK_ID = CASE WHEN C.LOCK_ID >= 255 THEN 1 ELSE C.LOCK_ID + 1 END
from COLLATERAL C
where id in (select id from unitrachdstorage..INC0416162_RV)



/*UPDATE C.COLLATERAL_CODE_ID of 90 to 250   --- Change Mcycle-OT code 90 to Mcycle code 250   */

SELECT C.*
----into unitrachdstorage..INC0416162_Mcycle
FROM LOAN L 
INNER JOIN COLLATERAL C ON C.LOAN_ID = L.ID
INNER JOIN LENDER LE ON LE.ID = L.LENDER_ID
INNER JOIN PROPERTY P ON P.ID = C.PROPERTY_ID
INNER JOIN COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
WHERE C.COLLATERAL_CODE_ID IN
(90)
AND LE.CODE_TX = '3035'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND L.RECORD_TYPE_CD <> 'D'
AND P.RECORD_TYPE_CD <> 'D'

update C 
set C.COLLATERAL_CODE_ID = 10, update_dt = GETDATE(), update_user_tx = 'INC0416162', C.LOCK_ID = CASE WHEN C.LOCK_ID >= 255 THEN 1 ELSE C.LOCK_ID + 1 END
from COLLATERAL C
where id in (select id from unitrachdstorage..INC0416162_Mcycle)