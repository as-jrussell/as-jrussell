USE [UniTrac];
GO

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT RC.* INTO UniTracHDStorage..Task43154
FROM   LOAN L
       INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
       INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
       INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
       INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
       INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
       INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
       INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE  LL.CODE_TX IN ( '1572' )
       AND L.NUMBER_TX IN ( '459670L6', '579891L6', '550612L6', '568551L6' ,
                            '520916L15' ,'564164L6', '532711L17.2' ,
                            '522718L27' ,'434881L6', '561759L17.1' ,
                            '490664L15' ,'509281L6', '534903L20', '531567L6' ,
                            '542243L6.1' ,'522979L6', '564362L6.1' ,
                            '562769L13' ,'407151L5', '461647L6', '495495L14' ,
                            '533053L6' ,'533053L6.2', '553711L6.1' ,
                            '567766L27.1' ,'511146L6.1', '581180L6' ,
                            '202324L6.1' ,'202446L6', '422721L5.2' ,
                            '502570L6' ,'509174L6.1', '510085L20.1' ,
                            '530281L15.1' ,'567680L6', '491574L6' ,
                            '534903L20.1' ,'544016L6.1', '560386L6' ,
                            '565450L5' ,'568360L6', '569168L6', '507376L6.2' ,
                            '571411L6' ,'516136L6', '546217L6', '546217L6.1' ,
                            '560232L6' ,'562183L6', '568240L6', '568275L6' ,
                            '587960L6' ,'510875L6.3', '517960L6', '522186L17' ,
                            '524301L20' ,'543143L6', '552612L6', '552612L6.1' ,
                            '552715L6.2' ,'558153L17.2', '567258L6' ,
                            '511837L6.1' ,'524619L15', '543127L6' ,
                            '550362L6.1' ,'561375L6.1', '588388L5' ,
                            '512630L6.1' ,'551686L6', '552336L6' ,
                            '494648L6.3' ,'557774L15', '562449L17' ,
                            '563487L6' ,'563862L6', '201817L17.1', '433802L5' ,
                            '584246L6' ,'97603L20', '123457L27', '483578L6' ,
                            '532677L6' ,'434033L6.1', '447004L6.2' ,
                            '467861L6.2' ,'473080L6', '515008L6.2' ,
                            '526484L6' ,'557223L6', '567312L6', '510110L6.2' ,
                            '542068L6' ,'554805L6', '560690L6', '587703L6' ,
                            '548074L6.3' ,'572613L6', '455061L6' ,
                            '499867L6.1' ,'576641L6', '579577L27', '581728L6' ,
                            '547878L6' ,'562517L6', '564386L6', '570735L6.1' ,
                            '657988L6' ,'448169L6', '657679L6.1', '441178L6' ,
                            '538708L6' ,'545910L6', '581567L6', '586058L6' ,
                            '544828L6.1' ,'578971L6', '579517L6', '368026L20' ,
                            '530578L6' ,'569001L6', '457549L6', '493599L6.1' ,
                            '550392L6' ,'551906L6.1', '563223L6.1' ,
                            '574432L6' ,'474404L6', '518584L5', '518584L5.1' ,
                            '550849L6' ,'564183L6.2', '566930L6', '570565L6' ,
                            '533150L6.1' ,'568249L6', '572929L6', '575580L6' ,
                            '453401L6' ,'485644L6', '492546L27.1' ,
                            '521052L20' ,'559744L6', '565999L6', '572601L6.1' ,
                            '461683L6' ,'484245L6', '492704L6', '533172L17.3' ,
                            '536255L17.1' ,'545483L6.1', '558153L20' ,
                            '84935L6' ,'509749L6.3', '556652L6.1', '566836L6' ,
                            '567480L6' ,'586061L6', '492845L6', '548486L6.1' ,
                            '549592L6' ,'550554L6', '565332L5', '539667L17.1' ,
                            '566739L6.2' ,'570026L6', '108563L6.2' ,
                            '485803L20' ,'500792L6.1', '500792L6.2' ,
                            '523741L6' ,'527005L6', '568180L6', '570031L6.2' ,
                            '584639L6' ,'487911L6.1', '556444L6.1' ,
                            '559046L6' ,'560805L6', '563222L6', '569329L6' ,
                            '569483L6' ,'585489L6', '112574L6.1', '313946L5' ,
                            '41975L15' ,'453108L6.2', '488082L6' ,
                            '488082L6.1' ,'510127L17.3', '546311L6' ,
                            '548689L13' ,'561179L6.2', '581063L6' ,
                            '81293L5.1' ,'441742L6.1', '491285L6.1' ,
                            '498195L6.1' ,'511045L6', '569585L5', '571655L6' ,
                            '657431L6.1' ,'423284L6', '454022L20' ,
                            '527191L6.1' ,'537847L6.1', '554241L6.1' ,
                            '558398L77' ,'559643L6', '562221L6', '582469L6' ,
                            '7160L6.2' ,'7160L6.3', '505519L6', '512506L6' ,
                            '521584L6.1' ,'524277L5', '541183L5.1' ,
                            '549541L6' ,'583404L5', '70112L27', '452942L27' ,
                            '502155L5.2' ,'518481L6.1', '521970L20' ,
                            '535086L6.1' ,'536617L6.2', '536849L27.1' ,
                            '548621L6' ,'550383L6', '555910L6.1', '560859L6' ,
                            '562636L6' ,'593300L6.1', '507098L6' ,
                            '542443L6.2' ,'543341L5', '549567L6', '563336L6' ,
                            '523335L6.1' ,'554687L6', '557158L6', '575846L27' ,
                            '588082L6' ,'442740L6', '477440L6.1' ,
                            '537539L6.3' ,'573017L6', '588256L6', '473928L6' ,
                            '487892L6' ,'487892L6.1', '555240L6.1' ,
                            '563045L6.1' ,'573214L5', '587332L6', '456852L6' ,
                            '541225L77' ,'548436L6.1', '548436L6.2' ,
                            '553247L6' ,'560668L5', '564877L6', '570507L6' ,
                            '616484L6' ,'533181L15', '536651L6.1', '566175L6' ,
                            '576068L6' ,'491568L6', '495146L6', '501934L6.1' ,
                            '554959L77' ,'555811L6', '555811L6.1', '574737L6' ,
                            '581546L6' ,'587144L6', '492841L6', '440384L17.7' ,
                            '440384L6' ,'508511L6', '483568L6'
                          );

UPDATE RC
SET RC.NOTICE_DT = NULL, RC.NOTICE_SEQ_NO = '0', RC.UPDATE_DT = GETDATE(), 
LOCK_ID = CASE WHEN LOCK_ID >= 255 THEN 1 ELSE LOCK_ID + 1 END, RC.UPDATE_USER_TX ='Task43154'
FROM dbo.REQUIRED_COVERAGE RC
WHERE ID IN (SELECT ID FROM UniTracHDStorage..Task43154)