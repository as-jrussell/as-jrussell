USE UNITRAC 

SELECT OP.BIA_ID[OP_BIA_ID], RC.BIA_ID [RC_BIA_ID], OP.ID [OP_ID], RC.ID [RC_ID] 
into #tmpA 
FROM OWNER_POLICY OP
JOIN PROPERTY_OWNER_POLICY_RELATE POPR ON POPR.OWNER_POLICY_ID = OP.ID
JOIN PROPERTY P ON P.ID = POPR.PROPERTY_ID 
join REQUIRED_COVERAGE rc on rc.PROPERTY_ID = P.ID
JOIN COLLATERAL C ON C.PROPERTY_ID = P.ID
JOIN LOAN L ON L.ID = C.LOAN_ID
JOIN LENDER LE ON LE.ID = L.LENDER_ID
WHERE OP.BIA_ID  IN (25235731) and RC.BIA_ID <> 25235731
AND L.RECORD_TYPE_CD = 'G'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND OP.PURGE_DT IS NULL
AND POPR.PURGE_DT IS NULL
AND L.STATUS_CD = 'A'
AND C.STATUS_CD = 'A'
AND P.RECORD_TYPE_CD = 'G'
AND LE.AGENCY_ID = 1
AND OP.CREATE_DT >= '2015-01-01'





SELECT OP.BIA_ID[OP_BIA_ID], RC.BIA_ID [RC_BIA_ID], OP.ID [OP_ID], RC.ID [RC_ID] 
into #tmpB
FROM OWNER_POLICY OP
JOIN PROPERTY_OWNER_POLICY_RELATE POPR ON POPR.OWNER_POLICY_ID = OP.ID
JOIN PROPERTY P ON P.ID = POPR.PROPERTY_ID 
join REQUIRED_COVERAGE rc on rc.PROPERTY_ID = P.ID
JOIN COLLATERAL C ON C.PROPERTY_ID = P.ID
JOIN LOAN L ON L.ID = C.LOAN_ID
JOIN LENDER LE ON LE.ID = L.LENDER_ID
WHERE OP.BIA_ID  IN (25183901)
AND L.RECORD_TYPE_CD = 'G'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND OP.PURGE_DT IS NULL
AND POPR.PURGE_DT IS NULL
AND L.STATUS_CD = 'A'
AND C.STATUS_CD = 'A'
AND P.RECORD_TYPE_CD = 'G'
AND LE.AGENCY_ID = 1
AND OP.CREATE_DT >= '2015-01-01'


select * 
into UnitracHDStorage..INC0378208_25235731_RC
 from Required_Coverage RC
where id in (select RC_ID from #tmpA) 


select * 
into UnitracHDStorage..INC0378208_25183901
 from Required_Coverage RC
where id in (select RC_ID from #tmpB)  


select * 
into UnitracHDStorage..INC0378208_25183901
from OWNER_POLICY OP
where id in (select OP_ID from #tmpB) 





update RC
set BIA_ID = '25235731', update_dt = GETDATE(), update_user_tx = 'INC0378208', LOCK_ID = LOCK_ID+1
--select BIA_ID,*
from Required_Coverage RC
where id in (select RC_ID from #tmpA) 




update OP
set BIA_ID = '25235731' , update_dt = GETDATE(), update_user_tx = 'INC0378208', LOCK_ID = LOCK_ID+1
--select BIA_ID,*
from OWNER_POLICY OP
where id in (select OP_ID from #tmpB) 



update RC
set BIA_ID = '25235731', update_dt = GETDATE(), update_user_tx = 'INC0378208', LOCK_ID = LOCK_ID+1
--select BIA_ID,*
from Required_Coverage RC
where id in (select RC_ID from #tmpB) 





SELECT OP.BIA_ID[OP_BIA_ID], RC.BIA_ID [RC_BIA_ID], OP.ID [OP_ID], RC.ID [RC_ID] 
--into #tmpA 
FROM OWNER_POLICY OP
JOIN PROPERTY_OWNER_POLICY_RELATE POPR ON POPR.OWNER_POLICY_ID = OP.ID
JOIN PROPERTY P ON P.ID = POPR.PROPERTY_ID 
join REQUIRED_COVERAGE rc on rc.PROPERTY_ID = P.ID
JOIN COLLATERAL C ON C.PROPERTY_ID = P.ID
JOIN LOAN L ON L.ID = C.LOAN_ID
JOIN LENDER LE ON LE.ID = L.LENDER_ID
WHERE OP.BIA_ID  IN (25235731) --and RC.BIA_ID <> 25235731
AND L.RECORD_TYPE_CD = 'G'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND OP.PURGE_DT IS NULL
AND POPR.PURGE_DT IS NULL
AND L.STATUS_CD = 'A'
AND C.STATUS_CD = 'A'
AND P.RECORD_TYPE_CD = 'G'
AND LE.AGENCY_ID = 1
AND OP.CREATE_DT >= '2015-01-01'





SELECT OP.BIA_ID[OP_BIA_ID], RC.BIA_ID [RC_BIA_ID], OP.ID [OP_ID], RC.ID [RC_ID] 
--into #tmpB
FROM OWNER_POLICY OP
JOIN PROPERTY_OWNER_POLICY_RELATE POPR ON POPR.OWNER_POLICY_ID = OP.ID
JOIN PROPERTY P ON P.ID = POPR.PROPERTY_ID 
join REQUIRED_COVERAGE rc on rc.PROPERTY_ID = P.ID
JOIN COLLATERAL C ON C.PROPERTY_ID = P.ID
JOIN LOAN L ON L.ID = C.LOAN_ID
JOIN LENDER LE ON LE.ID = L.LENDER_ID
WHERE OP.BIA_ID  IN (25183901)
AND L.RECORD_TYPE_CD = 'G'
AND L.PURGE_DT IS NULL
AND C.PURGE_DT IS NULL
AND P.PURGE_DT IS NULL
AND OP.PURGE_DT IS NULL
AND POPR.PURGE_DT IS NULL
AND L.STATUS_CD = 'A'
AND C.STATUS_CD = 'A'
AND P.RECORD_TYPE_CD = 'G'
AND LE.AGENCY_ID = 1
AND OP.CREATE_DT >= '2015-01-01'