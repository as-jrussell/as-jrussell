USE UniTrac

select * from UniTracHDStorage..INC0540719_1


select * from UniTracHDStorage..INC0540719_2


select * from UniTracHDStorage..INC0540719_3




select * INTO  unitrachdstorage..INC0540719_BU_RC_1
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_1 T ON T.[Property ID] = LO.PROPERTY_ID 




select * INTO  unitrachdstorage..INC0540719_BU_RC_2
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_2 T ON  T.[Property ID] = LO.PROPERTY_ID 




select * INTO  unitrachdstorage..INC0540719_BU_RC_3
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_3 T ON  T.[Property ID] = LO.PROPERTY_ID 


UPDATE LO
SET LO.RECORD_TYPE_CD = 'G', LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
--select RECORD_TYPE_CD, STATUS_CD, *
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_1 T ON   T.[Property ID] = LO.PROPERTY_ID 


INSERT INTO PROPERTY_CHANGE
 ( ENTITY_NAME_TX , ENTITY_ID , USER_TX , ATTACHMENT_IN , 
 CREATE_DT , AGENCY_ID , DESCRIPTION_TX ,  DETAILS_IN , FORMATTED_IN ,
 LOCK_ID , PARENT_NAME_TX , PARENT_ID , TRANS_STATUS_CD , UTL_IN )
 SELECT DISTINCT 'Allied.UniTrac.RequiredCoverage' , LO.ID , 'INC0540719' , 'N' , 
 GETDATE() ,  1 , 
'Loan record types to be set as Good and set to status Active', 
 'Y' , 'N' , 1 ,  'Allied.UniTrac.RequiredCoverage' , LO.ID , 'PEND' , 'N'
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_1 T ON   T.[Property ID] = LO.PROPERTY_ID 


UPDATE LO
SET LO.RECORD_TYPE_CD = 'D', LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
--select RECORD_TYPE_CD, *
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_2 T ON   T.[Property ID] = LO.PROPERTY_ID 


INSERT INTO PROPERTY_CHANGE
 ( ENTITY_NAME_TX , ENTITY_ID , USER_TX , ATTACHMENT_IN , 
 CREATE_DT , AGENCY_ID , DESCRIPTION_TX ,  DETAILS_IN , FORMATTED_IN ,
 LOCK_ID , PARENT_NAME_TX , PARENT_ID , TRANS_STATUS_CD , UTL_IN )
 SELECT DISTINCT 'Allied.UniTrac.Property' , LO.ID , 'INC0540719' , 'N' , 
 GETDATE() ,  1 , 
'Loan record types to be set as Deleted and set to status Unmatched', 
 'Y' , 'N' , 1 ,  'Allied.UniTrac.Property' , LO.ID , 'PEND' , 'N'
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_2 T ON   T.[Property ID] = LO.PROPERTY_ID 


UPDATE LO
SET LO.RECORD_TYPE_CD = 'D', LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
--select RECORD_TYPE_CD, *
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_3 T ON   T.[Property ID] = LO.PROPERTY_ID 



INSERT INTO PROPERTY_CHANGE
 ( ENTITY_NAME_TX , ENTITY_ID , USER_TX , ATTACHMENT_IN , 
 CREATE_DT , AGENCY_ID , DESCRIPTION_TX ,  DETAILS_IN , FORMATTED_IN ,
 LOCK_ID , PARENT_NAME_TX , PARENT_ID , TRANS_STATUS_CD , UTL_IN )
 SELECT DISTINCT 'Allied.UniTrac.Property' , LO.ID , 'INC0540719' , 'N' , 
 GETDATE() ,  1 , 
'Loan Number Set as Good and unmatched', 
 'Y' , 'N' , 1 ,  'Allied.UniTrac.Property' , LO.ID , 'PEND' , 'N'
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_3 T ON   T.[Property ID] = LO.PROPERTY_ID 


/*


UPDATE LO
SET LO.RECORD_TYPE_CD = T.RECORD_TYPE_CD, LO.STATUS_CD = T.STATUS_CD, LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719_BO', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_BU_RC_1  T ON   T.[Property ID] = LO.PROPERTY_ID 


UPDATE LO
SET LO.RECORD_TYPE_CD = T.RECORD_TYPE_CD, LO.STATUS_CD = T.STATUS_CD, LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719_BO', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_BU_RC_2  T ON   T.[Property ID] = LO.PROPERTY_ID 


UPDATE LO
SET LO.RECORD_TYPE_CD = T.RECORD_TYPE_CD, LO.STATUS_CD = T.STATUS_CD, LO.UPDATE_DT = GETDATE(), LO.UPDATE_USER_TX = 'INC0540719_BO', lo.LOCK_ID = (lo.LOCK_ID % 255) + 1
FROM dbo.REQUIRED_COVERAGE LO
JOIN unitrachdstorage..INC0540719_BU_RC_3  T ON   T.[Property ID] = LO.PROPERTY_ID 

*/