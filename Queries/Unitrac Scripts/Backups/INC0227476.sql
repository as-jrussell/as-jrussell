USE [UniTrac]
GO 

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT 
DISTINCT 
  FIRST_NAME_TX, LAST_NAME_TX, l.NUMBER_TX,
YEAR_TX, MAKE_TX, MODEL_TX, BRANCH_CODE_TX, BIC_NAME_TX,
 POLICY_NUMBER_TX, RR.DESCRIPTION_TX [RequiredCoverageInsStatus], RS.DESCRIPTION_TX [RequiredCoverageInsSubStatus]
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON c.PROPERTY_ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
INNER JOIN dbo.PROPERTY_OWNER_POLICY_RELATE POP ON POP.PROPERTY_ID = P.ID
INNER JOIN dbo.OWNER_POLICY OP ON OP.ID = POP.OWNER_POLICY_ID 
INNER JOIN dbo.POLICY_COVERAGE PC ON PC.OWNER_POLICY_ID = OP.ID
LEFT JOIN dbo.REF_CODE RR ON RR.CODE_CD = RC.INSURANCE_STATUS_CD AND RR.DOMAIN_CD = 'RequiredCoverageInsStatus'
LEFT JOIN dbo.REF_CODE RS ON RS.CODE_CD = RC.INSURANCE_SUB_STATUS_CD AND RS.DOMAIN_CD = 'RequiredCoverageInsSubStatus'
WHERE LL.CODE_TX IN ('5235') AND (OP.BIC_NAME_TX  IN ('Affirmative Insurance Company', 'AIC', 'Affirmative') or OP.BIC_NAME_TX  LIKE 'Affirmative%' OR OP.BIC_NAME_TX  LIKE '%AIC%' OR OP.BIC_NAME_TX  LIKE 'AFF%')
--AND MAKE_TX IS NOT NULL AND POLICY_NUMBER_TX NOT LIKE '%test%' AND YEAR_TX NOT LIKE '' AND L.NUMBER_TX NOT IN ('1111' , '30022222222222222')


 SELECT * FROM dbo.REF_CODE
 WHERE CODE_CD = 'D'

SELECT LO.TYPE_CD, LO.CODE_TX , Lo.NAME_TX,*
FROM LENDER L
INNER JOIN LENDER_ORGANIZATION LO ON L.ID = LO.LENDER_ID
INNER JOIN RELATED_DATA RD ON LO.ID = RD.RELATE_ID --AND RD.DEF_ID = '105'
WHERE L.CODE_TX = '5350' AND Lo.TYPE_CD = 'BRCH'


SELECT TOP 1 * FROM dbo.LOAN
WHERE NUMBER_TX = '0005002290L1'

