USE UniTrac


SELECT ID INTO #tmpPD
FROM    dbo.PROCESS_DEFINITION
WHERE   ( UPDATE_USER_TX LIKE 'LDH%'
          OR UPDATE_USER_TX LIKE 'MSG%'
          OR UPDATE_USER_TX LIKE '%PRT'
          OR UPDATE_USER_TX LIKE '%RPT'
          OR UPDATE_USER_TX LIKE 'WF%'
          OR UPDATE_USER_TX LIKE 'LetterGen'
        )
        AND ACTIVE_IN = 'Y'
        AND EXECUTION_FREQ_CD <> 'RUNONCE'
		ORDER BY ID ASC 



SELECT ID
INTO #tmpPLI
 FROM dbo.PROCESS_LOG
	WHERE STATUS_CD = 'InProcess' AND CAST(UPDATE_DT AS DATE) = CAST(GETDATE() AS DATE)
	AND PROCESS_DEFINITION_ID NOT IN (SELECT * FROM #tmpPD)
		ORDER BY CREATE_DT ASC  




SELECT * FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (SELECT * FROM #tmpPLI)
ORDER BY PROCESS_LOG_ID DESC 