USE ROLE --OWNER OF THE DB
USE WAREHOUSE --YOUR DEFAULT WAREHOUSE WOULD BE SUPPLIED 
USE DATABASE ---DATABASE WHERE SCHEMA IS GOING 


BEGIN
	CASE WHEN (select count(*) from information_schema.schemata  where CATALOG_NAME = 'database_name'AND SCHEMA_NAME = 'schema_name' ) = 0
	THEN

CREATE SCHEMA schema_name;
RETURN 'SUCCESS: Schema created';

ELSE 

RETURN 'WARNING: Schema exists';

	END;
    
END;
GRANT USAGE ON SCHEMA BOND TO ROLE READWRITE_BOND_STAGE;
GRANT USAGE ON SCHEMA BOND TO ROLE READ_BOND_STAGE;