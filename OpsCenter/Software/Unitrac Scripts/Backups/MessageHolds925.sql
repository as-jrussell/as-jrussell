-------Move to ADHOC

--BEGIN TRAN


UPDATE  MESSAGE
SET     RECEIVED_STATUS_CD = 'ADHOC'
WHERE   ID IN (4660529)



--ROLLBACK

--COMMIT

				
---Placing messages on hold
UPDATE dbo.MESSAGE
SET PROCESSED_IN = 'Y' , RECEIVED_STATUS_CD = 'HOLD' , LOCK_ID = LOCK_ID+1, UPDATE_USER_TX = 'JC'
WHERE ID IN (4658831, 4658832)


------Taking them off hold for USD
UPDATE  dbo.MESSAGE
SET     PROCESSED_IN = 'N' ,
        RECEIVED_STATUS_CD = 'RCVD' ,
        LOCK_ID = LOCK_ID + 1 ,
        UPDATE_USER_TX = 'JC'
WHERE   ID IN (4658890,
4658891,
4659814,
4659816,
4659835)



------Taking them off hold for ADHOC
--UPDATE dbo.MESSAGE
--SET PROCESSED_IN = 'N' , 
--LOCK_ID = LOCK_ID+1, 
--RECEIVED_STATUS_CD = 'ADHOC' 
--WHERE ID IN (XXXXXXX)


----Purge Message
--UPDATE dbo.MESSAGE
--SET PURGE_DT = GETDATE() , LOCK_ID = LOCK_ID+1, UPDATE_USER_TX = 'JC'
--WHERE ID IN (XXXXXXX)


SELECT * FROM dbo.MESSAGE
WHERE ID IN ( 4660357 )

SELECT  *
FROM    dbo.WORK_ITEM
WHERE   RELATE_ID IN ( 4659838 )

--No Valid Records in staging tables : tblExtract_26905271
--SELECT * FROM dbo.WORK_ITEM
--WHERE ID IN (XXXXXXX)

SELECT  *
FROM    MESSAGE
WHERE   ID IN ( 4659814, 4659816, 4659835, 4659836, 4659837, 4659838, 4659840,
                4659841, 4659842, 4659843, 4659844, 4659845, 4659846, 4659847,
                4659848, 4659849, 4659850, 4659851, 4659852, 4659853, 4659854,
                4659857, 4659858, 4659859, 4659860, 4660002, 4660228 )

SELECT  *
FROM    dbo.MESSAGE M
WHERE   M.UPDATE_USER_TX = 'JC'


SELECT  TP.EXTERNAL_ID_TX ,
        TP.NAME_TX ,
        TPL.LOG_MESSAGE ,
        TPL.LOG_SEVERITY_CD ,
        TPL.LOG_TYPE_CD ,
        TPL.CREATE_DT [TPL.CREATE_DT] ,
        M.*
FROM    dbo.MESSAGE M
        INNER JOIN dbo.TRADING_PARTNER_LOG TPL ON M.ID = TPL.MESSAGE_ID
        INNER JOIN dbo.TRADING_PARTNER TP ON TPL.TRADING_PARTNER_ID = TP.ID
WHERE   M.ID IN ( 4659814, 4659816, 4659835, 4659836, 4659837, 4659838,
                  4659840, 4659841, 4659842, 4659843, 4659844, 4659845,
                  4659846, 4659847, 4659848, 4659849, 4659850, 4659851,
                  4659852, 4659853, 4659854, 4659857, 4659858, 4659859,
                  4659860 )
        AND TPL.LOG_TYPE_CD = 'ERROR'
        AND TPL.CREATE_DT > '2015-09-25 08:13:51.510'
--M.UPDATE_USER_TX = 'JC'
ORDER BY TP.EXTERNAL_ID_TX ,
        M.ID ,
        TPL.CREATE_DT ASC


--Checking Errors Messages and WI
SELECT  *
FROM    dbo.WORK_ITEM
WHERE   RELATE_TYPE_CD = 'LDHLib.Message'
        AND RELATE_ID IN ( SELECT   ID
                           FROM     dbo.MESSAGE M
                           WHERE    M.PROCESSED_IN = 'Y'
                                    AND M.RECEIVED_STATUS_CD = 'ERR'
                                    AND M.UPDATE_DT > '2015-09-23' )

SELECT  *
FROM    dbo.MESSAGE M
WHERE   M.PROCESSED_IN = 'Y'
AND M.RECEIVED_STATUS_CD = 'RCVD'
        --AND M.RECEIVED_STATUS_CD = 'ERR'
        AND M.UPDATE_DT > '2015-09-25' AND UPDATE_USER_TX = 'MsgSrvrEXTUSD'


		

UPDATE dbo.MESSAGE
SET PROCESSED_IN = 'Y' , RECEIVED_STATUS_CD = 'ERR' , LOCK_ID = LOCK_ID+1, UPDATE_USER_TX = 'MsgSrvrEXTUSD'
WHERE UPDATE_USER_TX = 'JC'




SELECT  *
FROM    PROCESS_DEFINITION pd
WHERE   ID IN ( 7920, 12868, 13555, 13633, 74040, 199525 )



