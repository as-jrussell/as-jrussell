USE UniTrac	

SELECT DISTINCT EVENT_TYPE_CD FROM dbo.EVENT_SEQUENCE

SELECT DISTINCT E.ID INTO #tmpE  FROM dbo.EVENT_SEQ_CONTAINER E
JOIN dbo.ESC_ERD_RELATE EE ON EE.ESC_ID = E.ID
JOIN dbo.EVENT_REACTION_DEFINITION ERD ON ERD.ID = EE.ERD_ID
JOIN dbo.EVENT_STATUS ES ON ES.EVENT_REACTION_DEFINITION_ID = ERD.ID
JOIN dbo.LENDER_PRODUCT lp ON lp.id = LENDER_PRODUCT_ID
JOIN dbo.IMPAIRMENT_DEFINITION ID ON ID.LENDER_PRODUCT_ID = lp.ID
JOIN dbo.LENDER L ON L.ID = E.LENDER_ID
WHERE ID.TYPE_CD IN ('li', 'DD') AND l.CODE_TX = '5128'

SELECT * FROM dbo.REF_CODE
WHERE CODE_CD IN (SELECT DISTINCT EVENT_TYPE_CD FROM dbo.EVENT_SEQUENCE)


SELECT * FROM dbo.REF_CODE
WHERE CODE_CD IN (SELECT DISTINCT NOTICE_TYPE_CD FROM dbo.EVENT_SEQUENCE)



SELECT DISTINCT
        L.CODE_TX ,
        L.NAME_TX ,E.DESCRIPTION_TX[EventSequenceDescription],
		RC.DESCRIPTION_TX [EventSequenceEventType],
        LP.BASIC_TYPE_CD ,
        LP.BASIC_SUB_TYPE_CD ,
        LP.DESCRIPTION_TX, NOTICE_SEQ_NO, NOTICE_CYCLE_IN INTO jcs..noticereport
FROM    dbo.EVENT_SEQUENCE ES
        JOIN dbo.EVENT_SEQ_CONTAINER E ON E.ID = ES.EVENT_SEQ_CONTAINER_ID
        JOIN dbo.LENDER_PRODUCT LP ON E.LENDER_PRODUCT_ID = LP.ID
        JOIN dbo.LENDER L ON L.ID = E.LENDER_ID
		LEFT JOIN dbo.REF_CODE RC ON RC.CODE_CD = EVENT_TYPE_CD AND RC.DOMAIN_CD = 'EventSequenceEventType'
WHERE   ES.EVENT_SEQ_CONTAINER_ID IN ( SELECT   *
                                       FROM     #tmpE )
        AND ES.PURGE_DT IS NULL --AND ES.QUOTE_PREMIUM_IN != 'Y' AND ES.ORDER_NO IN ('1','2')
       -- AND EVENT_TYPE_CD = 'ISCT'
        AND l.STATUS_CD = 'ACTIVE'
        AND l.TEST_IN = 'N'
        AND E.DESCRIPTION_TX IN ( 'Deductible Impaired', 'Lienholder Impaired' )
		



SELECT TOP 5* FROM dbo.EVENT_SEQ_CONTAINER

        AND l.CODE_TX = '5128'

SELECT TOP 10 fpc.* FROM dbo.FORCE_PLACED_CERTIFICATE fpc
JOIN dbo.LOAN L ON L.ID = fpc.LOAN_ID
JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5128' AND l.EFFECTIVE_DT >= '2016-01-01'



USE UniTrac
SELECT * FROM dbo.LENDER_PRODUCT LP
JOIN dbo.LENDER L ON L.ID = LP.LENDER_ID
WHERE L.CODE_TX = '0004'


SELECT TOP 10 BASIC_TYPE_CD, * FROM dbo.EVENT_SEQUENCE ES
JOIN dbo.EVALUATION_EVENT EE ON EE.EVENT_SEQUENCE_ID = ES.ID
JOIN dbo.EVENT_SEQ_CONTAINER E ON E.ID = ES.EVENT_SEQ_CONTAINER_ID
JOIN  dbo.LENDER_PRODUCT LP ON lp.id = E.LENDER_PRODUCT_ID
JOIN dbo.LENDER L ON L.ID = LP.LENDER_ID
WHERE l.CODE_TX = '5128' AND EVENT_TYPE_CD = 'ISCT'
--AND  E.DESCRIPTION_TX LIKE  '%Leinholder%'


SELECT DISTINCT E.DESCRIPTION_TX
FROM dbo.EVENT_SEQUENCE ES
JOIN dbo.EVALUATION_EVENT EE ON EE.EVENT_SEQUENCE_ID = ES.ID
JOIN dbo.EVENT_SEQ_CONTAINER E ON E.ID = ES.EVENT_SEQ_CONTAINER_ID
JOIN  dbo.LENDER_PRODUCT LP ON lp.id = E.LENDER_PRODUCT_ID
JOIN dbo.LENDER L ON L.ID = LP.LENDER_ID
WHERE l.CODE_TX = '5128' AND EVENT_TYPE_CD = 'ISCT'
