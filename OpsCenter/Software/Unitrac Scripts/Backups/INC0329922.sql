USE UniTrac


SELECT * FROM dbo.LENDER
WHERE CODE_TX = '2250'

SELECT * FROM dbo.LENDER_ORGANIZATION
WHERE LENDER_ID = 252


SELECT LO.NAME_TX [Type],  dc.RELATE_CLASS_NAME_TX ,  N.SEQUENCE_NO,
dc.DISPLAY_DT ,dc.DISPLAY_DESC_TX , dc.PRINT_STATUS_CD ,
dc.PRINT_STATUS_ASSIGNED_DT , dc.RECIPIENT_TYPE_CD 
--INTO jcs..INC0328880_Modified_2
FROM dbo.DOCUMENT_CONTAINER dc
JOIN dbo.NOTICE N ON N.id = dc.RELATE_ID AND dc.RELATE_CLASS_NAME_TX = 'Allied.UniTrac.Notice' 
JOIN dbo.LOAN L ON L.ID = N.LOAN_ID AND L.LENDER_ID = '252'
JOIN dbo.LENDER_ORGANIZATION LO ON L.DIVISION_CODE_TX = Lo.CODE_TX AND LO.TYPE_CD = 'DIV' AND LO.LENDER_ID = '252'
WHERE dc.RECIPIENT_TYPE_CD = 'BORR' AND dc.PRINT_STATUS_CD <> 'VUT' AND dc.PRINT_STATUS_CD = 'PRINTED' AND 
 Dc.UPDATE_DT >= '2017-01-01'
UNION
SELECT LO.NAME_TX [Type], dc.RELATE_CLASS_NAME_TX , NULL ,
dc.DISPLAY_DT ,dc.DISPLAY_DESC_TX , dc.PRINT_STATUS_CD ,
dc.PRINT_STATUS_ASSIGNED_DT , dc.RECIPIENT_TYPE_CD  
FROM dbo.DOCUMENT_CONTAINER dc
JOIN dbo.FORCE_PLACED_CERTIFICATE N ON N.id = dc.RELATE_ID AND dc.RELATE_CLASS_NAME_TX ='Allied.UniTrac.ForcePlacedCertificate' AND dc.PRINT_STATUS_CD <> 'VUT'
JOIN dbo.LOAN L ON L.ID = N.LOAN_ID AND L.LENDER_ID = '252'
JOIN dbo.LENDER_ORGANIZATION LO ON L.DIVISION_CODE_TX = Lo.CODE_TX AND LO.TYPE_CD = 'DIV' AND LO.LENDER_ID = '252'
WHERE dc.RECIPIENT_TYPE_CD = 'BORR' AND dc.PRINT_STATUS_CD <> 'VUT' AND dc.PRINT_STATUS_CD = 'PRINTED' AND 
 Dc.UPDATE_DT >= '2017-11-01' AND   Dc.UPDATE_DT <= '2017-12-01' AND l.DIVISION_CODE_TX = '3'

ORDER BY dc.DISPLAY_DT ASC 




SELECT COUNT(N.ID), LO.CODE_TX, lo.NAME_TX
FROM dbo.DOCUMENT_CONTAINER dc
JOIN dbo.FORCE_PLACED_CERTIFICATE N ON N.id = dc.RELATE_ID AND dc.RELATE_CLASS_NAME_TX ='Allied.UniTrac.ForcePlacedCertificate' AND dc.PRINT_STATUS_CD <> 'VUT'
JOIN dbo.LOAN L ON L.ID = N.LOAN_ID AND L.LENDER_ID = '252'
JOIN dbo.LENDER_ORGANIZATION LO ON L.DIVISION_CODE_TX = Lo.CODE_TX AND LO.TYPE_CD = 'DIV' AND LO.LENDER_ID = '252'
WHERE dc.RECIPIENT_TYPE_CD = 'BORR' AND dc.PRINT_STATUS_CD <> 'VUT' AND dc.PRINT_STATUS_CD = 'PRINTED' AND 
 Dc.UPDATE_DT >= '2017-09-01'
 AND dc.PURGE_DT IS NULL AND L.PURGE_DT IS NULL AND N.PURGE_DT IS NULL
 GROUP BY LO.CODE_TX, LO.NAME_TX
--4324



SELECT COUNT(FPC.ID)
FROM FORCE_PLACED_CERTIFICATE FPC
JOIN FORCE_PLACED_CERT_REQUIRED_COVERAGE_RELATE FPCRCR ON FPCRCR.FPC_ID = FPC.ID AND FPCRCR.PURGE_DT IS NULL AND fpc.PURGE_DT IS NULL 
JOIN REQUIRED_COVERAGE RC ON FPCRCR.REQUIRED_COVERAGE_ID = RC.ID AND RC.PURGE_DT IS NULL
JOIN LOAN L ON L.ID = FPC.LOAN_ID	AND ISNULL(L.RECORD_TYPE_CD,'') IN('A', 'D', 'G') AND L.PURGE_DT IS NULL
JOIN dbo.DOCUMENT_CONTAINER dc ON fpc.id = dc.RELATE_ID AND dc.RELATE_CLASS_NAME_TX ='Allied.UniTrac.ForcePlacedCertificate' AND dc.PURGE_DT IS NULL 
WHERE  L.LENDER_ID = '252' AND  dc.RECIPIENT_TYPE_CD = 'BORR' AND dc.PRINT_STATUS_CD = 'PRINTED' AND  Dc.UPDATE_DT >= '2017-10-01' AND   Dc.UPDATE_DT <= '2017-11-01'


SELECT DISTINCT COUNT(L.DIVISION_CODE_TX), L.DIVISION_CODE_TX
FROM FORCE_PLACED_CERTIFICATE FPC
JOIN FORCE_PLACED_CERT_REQUIRED_COVERAGE_RELATE FPCRCR ON FPCRCR.FPC_ID = FPC.ID AND FPCRCR.PURGE_DT IS NULL AND fpc.PURGE_DT IS NULL 
JOIN REQUIRED_COVERAGE RC ON FPCRCR.REQUIRED_COVERAGE_ID = RC.ID AND RC.PURGE_DT IS NULL
JOIN LOAN L ON L.ID = FPC.LOAN_ID	AND ISNULL(L.RECORD_TYPE_CD,'') IN ('A', 'D', 'G') AND L.PURGE_DT IS NULL
JOIN dbo.DOCUMENT_CONTAINER dc ON fpc.id = dc.RELATE_ID AND dc.RELATE_CLASS_NAME_TX ='Allied.UniTrac.ForcePlacedCertificate' AND dc.PURGE_DT IS NULL 
WHERE  L.LENDER_ID = '252' AND  dc.RECIPIENT_TYPE_CD = 'BORR' AND dc.PRINT_STATUS_CD = 'PRINTED' AND  Dc.UPDATE_DT >= '2017-10-01' AND   Dc.UPDATE_DT <= '2017-11-01'
AND rc.TYPE_CD = 'PHYS-DAMAGE'
GROUP BY COUNT(L.DIVISION_CODE_TX
--159

SELECT DISTINCT TYPE_CD FROM dbo.REQUIRED_COVERAGE