USE UniTrac


SELECT -- DISTINCT
 TOP 10 *
--TP.EXTERNAL_ID_TX  [Lender Code] ,
--       tp.NAME_TX [Lender Name] ,
--	   LO.NAME_TX [Division],
--	  DOCUMENT_TYPE_CD [Division],
--        PD.TYPE_CD [Pre-Processing Details],
--        CU.TO_VALUE_TX [Enable First Line Of Insurance], C.CREATE_DT [Enable First Line Of Insurance Added],
--		RD.VALUE_TX [Import Configurations]

FROM    dbo.PREPROCESSING_DETAIL PD
        INNER JOIN dbo.PPDATTRIBUTE PPD ON PPD.PREPROCESSING_DETAIL_ID = PD.ID AND PPD.CODE_CD = 'EnableFirstLineOfInsurance' 
        INNER JOIN dbo.DELIVERY_INFO_GROUP D ON D.ID = PD.DELIVERY_INFO_GROUP_ID AND PD.TYPE_CD = 'Informatica'
        INNER JOIN dbo.DELIVERY_INFO DD ON DD.ID = D.DELIVERY_INFO_ID
        INNER JOIN dbo.TRADING_PARTNER TP ON TP.ID = DD.TRADING_PARTNER_ID
        INNER JOIN dbo.DELIVERY_INFO_DELIVER_TO_TP_RELATE DT ON DT.DELIVERY_INFO_ID = DD.ID
		INNER JOIN dbo.DELIVERY_INFO_EXTRACT_CONFIG_RELATE DIE ON DIE.DELIVERY_INFO_ID = DD.ID
		INNER JOIN dbo.CHANGE C ON C.ENTITY_ID = DD.ID AND C.ENTITY_NAME_TX = 'LDHLib.DeliveryInfo'
		INNER JOIN dbo.RELATED_DATA RD ON RD.DEF_ID = die.ID  
		INNER JOIN dbo.LENDER_ORGANIZATION LO ON LO.ID = RD.ID AND Lo.TYPE_CD = 'DIV'
INNER JOIN dbo.CHANGE_UPDATE CU ON C.ID = CU.CHANGE_ID  AND Cu.QUALIFIER_TX like '%Enable 1st Line of Insurance Processing%'
		LEFT OUTER JOIN RELATED_DATA_DEF rdd	ON (rdd.RELATE_CLASS_NM = 'DeliveryInfo' and rdd.NAME_TX = 'UniTracDeliveryType')
			WHERE CU.TO_VALUE_TX   IN ('Y', 'N') AND DIE.PURGE_DT IS NULL
		AND RD.VALUE_TX = 'IMPORT' 
	--	AND TP.EXTERNAL_ID_TX = '1946'



