USE [UniTrac]
GO 

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT P.ID, L.RECORD_TYPE_CD, FIRST_NAME_TX, LAST_NAME_TX, * FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
--SELECT * FROM dbo.LOAN L
WHERE LL.CODE_TX = '1916' AND L.RECORD_TYPE_CD = 'U' AND L.SOURCE_CD = 'UI' 

AND O.LAST_NAME_TX = 'Kenyon' AND O.FIRST_NAME_TX = 'Allen'


SELECT * FROM dbo.LENDER
WHERE CODE_TX IN ('4353') 

SELECT DISTINCT COUNT(NUMBER_TX) FROM dbo.LOAN
WHERE LENDER_ID = '2233'

SELECT  *
FROM    WORK_ITEM
WHERE   RELATE_TYPE_CD = 'Allied.UniTrac.UTLMatchResult'
        AND RELATE_ID IN (
        SELECT  UTL_LOAN_ID
        FROM    LOAN
                INNER JOIN COLLATERAL ON LOAN.ID = COLLATERAL.LOAN_ID-- AND COLLATERAL.PURGE_DT IS NULL
                INNER JOIN PROPERTY ON COLLATERAL.PROPERTY_ID = PROPERTY.ID
                INNER JOIN dbo.UTL_MATCH_RESULT ON PROPERTY.ID = UTL_MATCH_RESULT.PROPERTY_ID
                INNER JOIN LENDER ON LOAN.LENDER_ID = LENDER.ID
        WHERE   LENDER.CODE_TX = '1916' 
                AND WORK_ITEM.STATUS_CD NOT LIKE 'Complete'
                AND WORK_ITEM.STATUS_CD NOT LIKE 'Withdrawn' 
			   )

			   --allen kenyon

SELECT  *
        FROM    LOAN
                INNER JOIN COLLATERAL ON LOAN.ID = COLLATERAL.LOAN_ID AND COLLATERAL.PURGE_DT IS NULL
                INNER JOIN PROPERTY ON COLLATERAL.PROPERTY_ID = PROPERTY.ID
                INNER JOIN dbo.UTL_MATCH_RESULT ON PROPERTY.ID = UTL_MATCH_RESULT.PROPERTY_ID
                INNER JOIN LENDER ON LOAN.LENDER_ID = LENDER.ID
        WHERE   LENDER.CODE_TX = '1916' AND Loan.ID IN (142435299,
142435339)


--142426524
--142435299
--142435339

SELECT  * --INTO UniTracHDStorage..INC0218468
FROM    WORK_ITEM
WHERE   RELATE_TYPE_CD = 'Allied.UniTrac.UTLMatchResult'
        AND RELATE_ID IN (
63609313,
63609314,
63609315)



UPDATE dbo.WORK_ITEM
SET STATUS_CD = 'Complete'
--SELECT  * FROM    WORK_ITEM
WHERE  RELATE_TYPE_CD = 'Allied.UniTrac.UTLMatchResult'
        AND RELATE_ID IN (
63609313,
63609314,
63609315)

  SELECT
		  ID,
		  UTL_LOAN_ID,
		  UTL_PROPERTY_ID,
		  AGENCY_ID,
		  PROPERTY_ID,
		  LOAN_ID,
		  UTL_OWNER_POLICY_ID,
		  TXN_ID,
		  SCORE_NO,
		  SCORE_PERCENT_NO,
		  SCORE_DETAIL_XML,
		  MATCH_RESULT_CD,
		  USER_MATCH_RESULT_CD,
		  USER_MATCH_TX,
		  MSG_LOG_TX,
		  LOG_TX,
		  APPLY_STATUS_CD,
		  CRITERIA_XML,
		  ESCROW_IN,
		  LOCK_ID
	   FROM UTL_MATCH_RESULT
	   WHERE
		  UTL_LOAN_ID IN (SELECT L.ID FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
--SELECT * FROM dbo.LOAN L
WHERE LL.CODE_TX = '1916' AND L.RECORD_TYPE_CD = 'U' AND L.SOURCE_CD = 'UI' )


(SELECT * FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
--SELECT * FROM dbo.LOAN L
WHERE LL.CODE_TX = '1916' AND L.RECORD_TYPE_CD = 'U' AND L.SOURCE_CD = 'UI' )



SELECT * FROM dbo.UTL_MATCH_RESULT
WHERE ID IN (63609313,63609314,63609315)