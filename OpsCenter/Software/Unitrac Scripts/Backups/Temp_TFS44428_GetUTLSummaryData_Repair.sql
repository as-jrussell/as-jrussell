USE UniTrac


EXEC dbo.Temp_TFS44428_GetUTLSummaryData



SELECT DISTINCT LENDER_ID, LENDER_CODE_TX
--INTO #temp20Lenders
FROM Temp_TFS44428_UTL_MATCH_RESULT_SUMMARY_DATA

SELECT l.LENDER_ID,  
umr.MATCH_RESULT_CD, COUNT(*) UTL20Matches
,CAST(COUNT(*)/CAST((DATEDIFF(DAY,  MIN(umr.CREATE_DT), GETDATE())) AS NUMERIC(18,5)) AS NUMERIC(18,5)) UTL20AvgDaileyMatches
--INTO #utl20
FROM UTL_MATCH_RESULT umr
INNER JOIN LOAN l ON umr.UTL_LOAN_ID = l.ID
WHERE 
umr.UTL_VERSION_NO = 2 
AND l.LENDER_ID IN ( 13,92,435,709,853,962,1810,1833,1880,2048,2184,2225,2226,2296, 2239,
2354,2352, 2409,2371,2338,2327,2314,2306, 2245)
GROUP BY l.LENDER_ID, umr.MATCH_RESULT_CD


--45094


/*
2243,2352
*/


SELECT * FROM dbo.LENDER
WHERE NAME_TX LIKE '%well%'

SELECT COUNT(*) FROM UTL_MATCH_RESULT umr
    INNER JOIN LOAN l
        ON umr.UTL_LOAN_ID = l.ID
WHERE l.LENDER_ID IN ( 2409 )
      AND umr.UTL_VERSION_NO = 2

SELECT l.LENDER_ID,
       CAST(COUNT(*) / CAST((DATEDIFF(DAY, MIN(umr.CREATE_DT), GETDATE())) AS NUMERIC(18, 5)) AS NUMERIC(18, 5)) UTL20AvgDaileyMatches
FROM UTL_MATCH_RESULT umr
    INNER JOIN LOAN l
        ON umr.UTL_LOAN_ID = l.ID
WHERE umr.id  IN (138019163,
138019164,
138019165,
138019166,
138019167)--, 138059814, 138059815, 138059816, 138059817, 138059818, 138059819, 138059820, 138059821, 138059822)
      AND umr.UTL_VERSION_NO = 2
GROUP BY l.LENDER_ID,
         umr.MATCH_RESULT_CD;

		 --

SELECT umr.CREATE_DT, * FROM UTL_MATCH_RESULT umr
    INNER JOIN LOAN l
        ON umr.UTL_LOAN_ID = l.ID
WHERE umr.ID  IN (137139352, 137137242, 137139353, 137139355, 138059814, 138059815, 138059816, 138059817, 138059818, 138059819, 138059820, 138059821, 138059822)

SELECT umr.CREATE_DT, umr.*
FROM UTL_MATCH_RESULT umr
    INNER JOIN LOAN l
        ON umr.UTL_LOAN_ID = l.ID
WHERE  umr.UTL_VERSION_NO = 2 --AND l.RECORD_TYPE_CD  = 'I'
	  AND umr.CREATE_DT >= '2018-04-16 '
	  AND umr.ID NOT IN (137139352, 137137242, 137139353, 137139355, 138059814, 138059815, 138059816, 138059817, 138059818, 138059819, 138059820, 138059821, 138059822)
	  ORDER BY umr.CREATE_DT ASC 
			/*
			137137242
			
			*/	





EXEC dbo.Temp_TFS44428_GetUTLSummaryData