USE [UniTrac]
GO 


SELECT * FROM dbo.LENDER
WHERE CODE_TX = '5310'

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT *  FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE --NUMBER_TX IN ('34864743', '79111450')

VIN_TX = '1G1AB5F59A7101604'


SELECT TOP 1 * FROM dbo.LOAN
WHERE LENDER_ID = '2184'
AND STATUS_CD = 'A' AND UPDATE_USER_TX NOT IN('Task36462', 'INC0229265')

SELECT * FROM dbo.LOAN
WHERE NUMBER_TX IN ('34864743', '79111450')

SELECT L. * 
--INTO UniTracHDStorage..INC0229265L
FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'



SELECT C. * 
--INTO UniTracHDStorage..INC0229265C
FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'

SELECT * FROM dbo.REF_CODE
WHERE CODE_CD = 'A'
AND DOMAIN_CD = 'LoanStatus'


SELECT P. *
--INTO UniTracHDStorage..INC0229265P
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'


SELECT RC. *
--INTO UniTracHDStorage..INC0229265RC
  FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'

SELECT O. *
--INTO UniTracHDStorage..INC0229265O
  FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'


SELECT OA. *
--INTO UniTracHDStorage..INC0229265OA
  FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'

SELECT OL. *
--INTO UniTracHDStorage..INC0229265OL
  FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE LL.CODE_TX = '5310'  AND VIN_TX = '1G1AB5F59A7101604'


SELECT * FROM dbo.REF_CODE
WHERE DOMAIN_CD = 'RequiredCoverageInsStatus'

 CODE_CD = 'A'


UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM Loan L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265L)

UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.COLLATERAL L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265C)

UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.PROPERTY L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265P)


UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.REQUIRED_COVERAGE L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265RC)


UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.OWNER L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265O)



UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.OWNER_ADDRESS L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265OA)



UPDATE L
SET L.PURGE_DT = NULL, L.UPDATE_DT = GETDATE(), L.UPDATE_USER_TX = 'INC0229265', L.LOCK_ID=L.LOCK_ID+1
--SELECT PURGE_DT, * 
FROM dbo.OWNER_LOAN_RELATE L
WHERE L.ID IN (SELECT ID FROM  UniTracHDStorage..INC0229265OL)


SELECT * FROM  UniTracHDStorage..INC0229265L

SELECT * FROM  UniTracHDStorage..INC0229265C


SELECT * FROM UniTracHDStorage..INC0229265P

SELECT * FROM UniTracHDStorage..INC0229265RC

SELECT * FROM UniTracHDStorage..INC0229265O

SELECT * FROM UniTracHDStorage..INC0229265OA

SELECT * FROM UniTracHDStorage..INC0229265OL
