USE [UniTrac]
GO 

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT l.DIVISION_CODE_TX,
--RC.TYPE_CD,
 Rc.* 
FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
INNER JOIN dbo.COLLATERAL_CODE CC ON C.COLLATERAL_CODE_ID = CC.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'

SELECT * FROM dbo.LENDER
WHERE Id = '11'

SELECT * FROM dbo.COLLATERAL_CODE
WHERE CODE_TX = 'HELOC'

SELECT L.*
INTO UniTracHDStorage..INC0243654_L
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'


SELECT C.*
INTO UniTracHDStorage..INC0243654_C
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'


SELECT P.*
INTO UniTracHDStorage..INC0243654_P
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'


SELECT RC.*
INTO UniTracHDStorage..INC0243654_RC
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'


SELECT OL.*
INTO UniTracHDStorage..INC0243654_OL
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'


SELECT O.*
INTO UniTracHDStorage..INC0243654_O
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'



SELECT OA.*
INTO UniTracHDStorage..INC0243654_OA
 FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.NUMBER_TX = '100016152-13'
AND L.LENDER_ID = '11'



UPDATE dbo.PROPERTY
SET ADDRESS_ID = '149474828', UPDATE_DT = GETDATE(), LOCK_ID = LOCK_ID+1,
UPDATE_USER_TX = 'INC0243654'
WHERE id IN (114611185,114611187)

UPDATE dbo.OWNER 
SET ADDRESS_ID = '149474828',UPDATE_DT = GETDATE(), LOCK_ID = LOCK_ID+1,
UPDATE_USER_TX = 'INC0243654'
WHERE ID IN (141915145,141915146,141915148,141915149)


UPDATE dbo.LOAN
SET DIVISION_CODE_TX = '4',UPDATE_DT = GETDATE(), LOCK_ID = LOCK_ID+1,
UPDATE_USER_TX = 'INC0243654'
WHERE id IN (141859655,141859657)



UPDATE dbo.COLLATERAL
SET COLLATERAL_CODE_ID = '230',UPDATE_DT = GETDATE(), LOCK_ID = LOCK_ID+1,
UPDATE_USER_TX = 'INC0243654'
WHERE ID IN (115887189,
115887191)


UPDATE dbo.REQUIRED_COVERAGE
SET PURGE_DT = GETDATE(), UPDATE_DT = GETDATE(), LOCK_ID = LOCK_ID+1,
UPDATE_USER_TX = 'INC0243654'
WHERE id IN (115761645,115761647)

