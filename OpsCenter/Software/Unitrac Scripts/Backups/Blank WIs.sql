USE UniTrac


SELECT TOP 1 * FROM dbo.PROCESS_LOG
WHERE MSG_TX IS NOT NULL AND MSG_TX <> 'Reset'




SELECT DISTINCT UPDATE_USER_TX 
INTO #tmp
FROM dbo.PROCESS_DEFINITION
WHERE PROCESS_TYPE_CD IN ('CYCLEPRC','BILLING') AND UPDATE_USER_TX LIKE 'UBS%'


SELECT PL.ID INTO #tmpPLL
FROM dbo.PROCESS_LOG PL
INNER JOIN dbo.PROCESS_DEFINITION PD ON PD.ID = PL.PROCESS_DEFINITION_ID
WHERE-- PL.MSG_TX = 'Total WorkItems processed: 0' AND 
 PL.UPDATE_USER_TX IN (SELECT * FROM #tmp) 
AND CAST(PL.UPDATE_DT AS DATE) >= CAST(GETDATE()-1 AS DATE) AND  
PD.PROCESS_TYPE_CD IN ('CYCLEPRC','BILLING') AND PL.PURGE_DT IS NULL



SELECT * 
--INTO UniTracHDStorage..AAA
FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (SELECT ID FROM #tmpPLL)
ORDER BY PROCESS_LOG_ID DESC




SELECT * FROM dbo.PROCESS_LOG



/*ID
32959642
32959760
32959641
32959583
32963522
32965025
32962642
32978285
32983149
32983421
32983391
32985707
32984493
32986692
32984689*/




SELECT  PD.NAME_TX ,
        PD.PROCESS_TYPE_CD ,
        PL.* 
--INTO UniTracHDStorage..AA
FROM    dbo.PROCESS_LOG PL
        INNER JOIN dbo.PROCESS_DEFINITION PD ON PD.ID = PL.PROCESS_DEFINITION_ID
WHERE   PL.ID IN ( 32959642, 32959760, 32959641, 32959583, 32963522, 32965025,
                   32962642, 32978285, 32983149, 32983421, 32983391, 32985707,
                   32984493, 32986692, 32984689 )






SELECT WO.*
FROM dbo.WORK_ITEM WI
LEFT JOIN #tmpPL2 WO ON WO.ID = WI.RELATE_ID
WHERE



SELECT * 
FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (SELECT ID FROM #tmpPL3)
ORDER BY PROCESS_LOG_ID DESC



SELECT * FROM dbo.PROCESS_LOG
WHERE ID IN (
SELECT PROCESS_LOG_ID 
FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (SELECT ID FROM #tmpPL3))


SELECT * FROM dbo.PROCESS_DEFINITION
WHERE ID IN (
SELECT PROCESS_DEFINITION_ID FROM dbo.PROCESS_LOG
WHERE ID IN (
SELECT PROCESS_LOG_ID 
--INTO UniTracHDStorage..AAA
FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (SELECT ID FROM #tmpPL3)))



SELECT * FROM #tmpPLL




SELECT WO.*, WI.*
--INTO #tmpPDDD
FROM dbo.WORK_ITEM WI
RIGHT JOIN #tmpPLL WO ON WO.ID = WI.RELATE_ID
WHERE WO.ID IS NOT NULL AND WORKFLOW_DEFINITION_ID IN (9, 10)
 AND  WI.CONTENT_XML.value('(/Content/Coverage/Type)[1]', 'varchar (50)') IS NULL

SELECT  PD.NAME_TX ,
        PD.PROCESS_TYPE_CD ,
        PL.* 
FROM    dbo.PROCESS_LOG PL
        INNER JOIN dbo.PROCESS_DEFINITION PD ON PD.ID = PL.PROCESS_DEFINITION_ID
WHERE   PL.ID IN ( SELECT * FROM #tmpPDDD)



SELECT * FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN ( SELECT * FROM #tmpPDDD)
AND RELATE_TYPE_CD LIKE '%work%'




SELECT
WI.* FROM dbo.WORK_ITEM WI
WHERE WI.WORKFLOW_DEFINITION_ID IN (9,10)
AND CAST(WI.UPDATE_DT AS DATE) >= CAST(GETDATE()-1 AS DATE)
 AND  WI.CONTENT_XML.value('(/Content/Coverage/Type)[1]', 'varchar (50)') IS NULL





SELECT * FROM dbo.WORK_ITEM WI
WHERE WI.WORKFLOW_DEFINITION_ID IN (9,10)
AND CAST(WI.UPDATE_DT AS DATE) >= CAST(GETDATE()-1 AS DATE)
 AND  WI.CONTENT_XML.value('(/Content/Coverage/Type)[1]', 'varchar (50)') IS NULL

 SELECT dbo.PROCESS_DEFINITION.NAME_TX,  * FROM dbo.PROCESS_LOG
 INNER JOIN dbo.PROCESS_DEFINITION ON PROCESS_DEFINITION.ID = PROCESS_LOG.PROCESS_DEFINITION_ID
 WHERE dbo.PROCESS_LOG.ID IN (SELECT * FROM #tmpPDA) AND dbo.PROCESS_LOG.STATUS_CD = 'COMP'


 SELECT * FROM dbo.REPORT_HISTORY
 WHERE STATUS_CD= 'PEND'
 AND REPORT_ID = '35'

 SELECT * FROM dbo.REPORT