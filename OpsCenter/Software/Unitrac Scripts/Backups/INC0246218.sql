SELECT * FROM dbo.LENDER
WHERE CODE_TX = '1880'

SELECT  * INTO UniTracHDStorage.dbo.LOAN_1880_1
FROM    dbo.LOAN
WHERE   LENDER_ID IN ( 947 )
        AND NUMBER_TX IN ( '0000075926-11', '0000187879-12', '0000330332-12',
                           '0000367915-15', '0000368895-11', '0000369336-11',
                           '0000377022-11', '0000389202-12', '0000406254-12',
                           '0000415235-12', '0000430838-11', '0000445111-11',
                           '0000451320-11', '0000466384-11', '0000470682-01',
                           '0000516322-10', '0000500649-10', '0000508433-10',
                           '0000509091-10', '0000513291-10', '0000513886-10',
                           '0000515349-10', '0000516567-10', '0000517820-10',
                           '0000517855-10', '0000518436-10', '0000520585-10',
                           '0000520753-10', '0000520977-10' )

SELECT * FROM UniTracHDStorage.dbo.LOAN_1880_1

UPDATE  Loan
SET     NUMBER_TX = '0000075926-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000075926-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000187879-0012' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000187879-12'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000330332-0012' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000330332-12'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000367915-0015' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000367915-15'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000368895-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000368895-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000369336-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000369336-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000377022-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000377022-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000389202-0012' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000389202-12'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000406254-0012' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000406254-12'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000415235-0012' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000415235-12'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000430838-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000430838-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000445111-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000445111-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000451320-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000451320-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000466384-0011' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000466384-11'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000470682-01' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000470682-01'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000516322-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000516322-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000500649-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000500649-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000508433-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000508433-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000509091-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000509091-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000513291-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000513291-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000513886-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000513886-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000515349-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000515349-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000516567-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000516567-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000517820-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000517820-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000517855-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000517855-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000518436-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000518436-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000520585-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000520585-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000520753-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000520753-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;
UPDATE  Loan
SET     NUMBER_TX = '0000520977-0010' ,
        UPDATE_DT = GETDATE() ,
        UPDATE_USER_TX = 'INC0246218'
WHERE   NUMBER_TX = '0000520977-10'
        AND LENDER_ID = 947
        AND PURGE_DT IS NULL;




--2) INSERT into PROPERTY_CHANGE table
INSERT INTO PROPERTY_CHANGE (ENTITY_NAME_TX,ENTITY_ID,USER_TX,ATTACHMENT_IN,CREATE_DT,AGENCY_ID,DETAILS_IN,FORMATTED_IN,LOCK_ID,PARENT_NAME_TX,PARENT_ID,TRANS_STATUS_CD,UTL_IN)
SELECT 'Allied.UniTrac.Loan',LOAN.ID,'INC0246218','N','2016-08-29 00:00:00.000',1,'Y','N',1,'Allied.UniTrac.Loan',LOAN.ID,'PEND','N'
FROM LOAN
WHERE ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1880_1)
--42


--3) INSERT into PROPERTY_CHANGE_UPDATE table
INSERT INTO PROPERTY_CHANGE_UPDATE (CHANGE_ID, TABLE_NAME_TX, TABLE_ID, COLUMN_NM, FROM_VALUE_TX,TO_VALUE_TX,DATATYPE_NO,CREATE_DT,DISPLAY_IN,OPERATION_CD)
select PROPERTY_CHANGE.ID,'LOAN',ENTITY_ID,'NUMBER_TX',UnitracHDStorage.dbo.LOAN_1880_1.NUMBER_TX,LOAN.NUMBER_TX,1,'2016-08-29 00:00:00.000','Y','U'
from PROPERTY_CHANGE
INNER JOIN LOAN ON PROPERTY_CHANGE.ENTITY_ID = LOAN.ID AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
INNER JOIN UnitracHDStorage.dbo.LOAN_1880_1 ON LOAN.ID = UnitracHDStorage.dbo.LOAN_1880_1.ID --AND ENTITY_NAME_TX = 'Allied.UniTrac.Loan' 
WHERE PROPERTY_CHANGE.CREATE_DT = '2016-08-29 00:00:00.000'
AND ENTITY_ID IN (SELECT ID FROM UnitracHDStorage.dbo.LOAN_1880_1)
--0

---4) Insert into LOAN_NUMBER Table (Leave old numbers for matching purposes)

INSERT INTO LOAN_NUMBER (LOAN_ID,NUMBER_TX,EFFECTIVE_DT,CREATE_DT,UPDATE_DT,UPDATE_USER_TX, LOCK_ID)
SELECT dbo.LOAN.ID, dbo.LOAN.NUMBER_TX,dbo.LOAN.EFFECTIVE_DT,GETDATE(),GETDATE(),'INC0246218',1
FROM UnitracHDStorage.dbo.LOAN_1880_1 HD INNER JOIN dbo.LOAN ON HD.ID = LOAN.ID
--42

--5) Full Text Search Updates

--Create updates
SELECT 'EXEC SaveSearchFullText', PROPERTY.ID 
FROM PROPERTY
INNER JOIN COLLATERAL ON PROPERTY.ID = COLLATERAL.PROPERTY_ID
AND LOAN_ID in (select ID FROM UnitracHDStorage.dbo.LOAN_1880_1)
--42

EXEC SaveSearchFullText	5340820
EXEC SaveSearchFullText	5340820
EXEC SaveSearchFullText	5538075
EXEC SaveSearchFullText	5538075
EXEC SaveSearchFullText	5572008
EXEC SaveSearchFullText	5572008
EXEC SaveSearchFullText	5618156
EXEC SaveSearchFullText	5618156
EXEC SaveSearchFullText	5645697
EXEC SaveSearchFullText	5645697
EXEC SaveSearchFullText	8280983
EXEC SaveSearchFullText	20259592
EXEC SaveSearchFullText	8280983
EXEC SaveSearchFullText	12282704
EXEC SaveSearchFullText	12826197
EXEC SaveSearchFullText	12826197
EXEC SaveSearchFullText	14254392
EXEC SaveSearchFullText	15094117
EXEC SaveSearchFullText	15094134
EXEC SaveSearchFullText	15094134
EXEC SaveSearchFullText	17114709
EXEC SaveSearchFullText	17114715
EXEC SaveSearchFullText	19374475
EXEC SaveSearchFullText	25011737
EXEC SaveSearchFullText	25011798
EXEC SaveSearchFullText	28329570
EXEC SaveSearchFullText	28329587
EXEC SaveSearchFullText	29566929
EXEC SaveSearchFullText	33838141
EXEC SaveSearchFullText	45339974
EXEC SaveSearchFullText	53474545
EXEC SaveSearchFullText	54375723
EXEC SaveSearchFullText	58254658
EXEC SaveSearchFullText	61538710
EXEC SaveSearchFullText	61538714
EXEC SaveSearchFullText	63123807
EXEC SaveSearchFullText	64197613
EXEC SaveSearchFullText	64197723
EXEC SaveSearchFullText	65675590
EXEC SaveSearchFullText	65675598
EXEC SaveSearchFullText	65675644
EXEC SaveSearchFullText	71732008
EXEC SaveSearchFullText	71732010
EXEC SaveSearchFullText	71732022
EXEC SaveSearchFullText	58254658
EXEC SaveSearchFullText	33838141
EXEC SaveSearchFullText	64197613
EXEC SaveSearchFullText	45339974
EXEC SaveSearchFullText	13470837
EXEC SaveSearchFullText	13470825
EXEC SaveSearchFullText	13470825
EXEC SaveSearchFullText	13470823
EXEC SaveSearchFullText	12282728
EXEC SaveSearchFullText	12282728
EXEC SaveSearchFullText	8280989
EXEC SaveSearchFullText	8280992
EXEC SaveSearchFullText	8280989
EXEC SaveSearchFullText	5471807
EXEC SaveSearchFullText	5471807
EXEC SaveSearchFullText	5150728
EXEC SaveSearchFullText	5150728
EXEC SaveSearchFullText	53474545
EXEC SaveSearchFullText	54375723
EXEC SaveSearchFullText	61538714
EXEC SaveSearchFullText	61538710
EXEC SaveSearchFullText	63123807
EXEC SaveSearchFullText	64197723
EXEC SaveSearchFullText	65675590
EXEC SaveSearchFullText	65675598
EXEC SaveSearchFullText	65675644
EXEC SaveSearchFullText	71732010
EXEC SaveSearchFullText	71732008
EXEC SaveSearchFullText	71732022