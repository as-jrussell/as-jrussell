USE unitrac

SELECT  CC2.CODE_TX ,
        I.[Change to] ,
        CC.CODE_TX ,
        I.[Collateral Code] ,
        *
FROM    UniTracHDStorage..INC0300079_Info I
        JOIN dbo.COLLATERAL_CODE CC ON CC.CODE_TX = I.[Collateral Code]
        JOIN dbo.COLLATERAL_CODE CC2 ON CC2.CODE_TX = I.[Change to]



SELECT  P.*
INTO    UniTracHDStorage..INC0300079
FROM    dbo.PROPERTY p
        JOIN UniTracHDStorage..INC0300079_Info I ON I.[VIN] = P.VIN_TX
WHERE   P.LENDER_ID = 57


UPDATE  C
SET     C.COLLATERAL_CODE_ID = CC2.ID
FROM    dbo.PROPERTY p
        JOIN UniTracHDStorage..INC0300079_Info I ON I.[VIN] = P.VIN_TX
        JOIN dbo.COLLATERAL C ON C.PROPERTY_ID = p.ID
        JOIN dbo.COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
        JOIN dbo.COLLATERAL_CODE CC2 ON CC2.CODE_TX = I.[Change to]
WHERE   P.LENDER_ID = 57



SELECT DISTINCT
        CC.CODE_TX ,
        P.VIN_TX
FROM    dbo.COLLATERAL C
        JOIN dbo.PROPERTY P ON P.ID = C.PROPERTY_ID
        JOIN dbo.COLLATERAL_CODE CC ON CC.ID = C.COLLATERAL_CODE_ID
        JOIN UniTracHDStorage..INC0300079_Info I ON I.[VIN] = P.VIN_TX
WHERE   LEN(VIN_TX) = '1'
        AND p.VIN_TX NOT IN ( '', 'X' )
ORDER BY p.VIN_TX ASC 

SELECT  L.NUMBER_TX,C.* INTO UniTracHDStorage..INC0300079_R
FROM    dbo.LOAN L
        JOIN dbo.COLLATERAL C ON C.LOAN_ID = L.ID
WHERE   L.NUMBER_TX IN ( '*8115794L42.1', '*8125337L67', '1099670L23.1',
                         '1156670L36', '1237940L31', '1258800L42.1',
                         '1286450L42.2', '1290230L36', '1303850L36',
                         '1308980L42', '1344600L36', '1350950L42',
                         '1377860L36', '1414320L42.1', '1526110L42',
                         '1559860L36', '1605640L31', '1611330L42.1',
                         '1615470L42', '1638730L36', '1638730L36',
                         '1641450L42', '1657380L36', '1768670L67',
                         '1768670L67', '1768750L67', '1785330L42.3',
                         '1791760L36.1', '1807940L42.1', '1812890L61',
                         '1812890L61', '1859340L42', '1869240L15',
                         '1925000L42.1', '2113750L42', '2313810L23',
                         '2313810L42.1', '2567760L36.1', '2641190L62',
                         '2644080L36', '2664030L42.1', '2716920L31.1',
                         '2718090L36', '2738960L31', '283320L61', '283320L61',
                         '283320L61', '2833820L42', '2835150L42.5',
                         '2838460L31', '2897020L42', '2897100L42.2',
                         '2897440L42', '2912290L61', '293060L31', '2934980L42',
                         '2943480L42.1', '2947440L61', '2949180L61',
                         '2949180L61', '2958570L42.1', '2965250L42.1',
                         '3035520L61', '3048990L42.3', '3051440L36.1',
                         '3065890L36.1', '3163150L42.1', '3198970L42',
                         '3198970L67', '3198970L67', '3230630L15',
                         '3278410L61', '3282030L61', '3305300L61',
                         '3305300L61', '3316520L31', '3318010L67.1',
                         '3331040L42', '3336580L60', '3345570L42',
                         '3359760L42', '3399600L61', '3438480L42',
                         '3450820L42', '3450820L42', '3456520L42',
                         '3471610L42', '3479140L36', '3521200L42',
                         '3524500L42', '3534410L23', '3546470L42',
                         '3586630L42', '3593640L42.1', '3597030L42.1',
                         '3622690L31.1', '3622690L42', '3633900L42',
                         '3647600L62', '3648440L42.2', '3648440L42.3',
                         '3703120L42', '3713020L42', '3714760L65',
                         '3729380L36', '3729610L66', '3736960L42',
                         '3758810L36.1', '3767310L36', '3810530L67',
                         '3819540L66', '382650L31', '3840650L67', '3840650L67',
                         '3872900L61', '3924490L62', '3925300L42.2',
                         '3983960L36', '3999640L42', '4005070L42',
                         '4021490L40', '4055710L36', '4056960L36',
                         '4056960L36', '4060740L42', '4074520L36', '427130L62',
                         '480740L61', '482490L42', '5013380L31',
                         '5048110L42.3', '5090670L23', '5114930L42',
                         '5127490L61', '5131010L42', '5216900L61',
                         '5216900L61', '5216900L67', '5276970L42',
                         '5303110L61', '5333230L36.1', '534390L31',
                         '5356250L67', '5410030L62', '541550L31', '5475620L36',
                         '5480080L36', '5480570L62', '5480570L62',
                         '5486100L36', '5486100L36', '5486100L36',
                         '5486100L36', '5486100L36', '5486100L36',
                         '5486100L36.1', '5492530L62', '5554820L62.1',
                         '5559120L42.1', '5559530L42', '5565550L42',
                         '5586500L36', '5604330L36', '5648490L42',
                         '5653660L42', '5656300L42.3', '5656300L62',
                         '5656300L67.2', '5662320L42', '567390L23',
                         '5676850L42', '5679740L42', '5709860L36',
                         '5712160L36', '5731880L31', '5742930L42.1',
                         '5747640L42', '5753240L42.1', '5753730L42',
                         '5753730L42.1', '5756210L23', '5757200L62',
                         '5767770L42.1', '5768350L67', '5773120L66',
                         '5790520L36.2', '5790520L36.2', '5824110L42',
                         '5856610L31', '5856610L66', '5873940L42',
                         '5883920L62', '5883920L62', '5921540L67',
                         '5950740L42.1', '5974010L42', '5992580L42',
                         '5993080L62', '6008580L42.1', '6011040L61',
                         '6066320L67', '6102040L42', '6137290L60',
                         '6141800L42.1', '6146100L36.1', '6159480L61',
                         '6159480L61', '6278020L42', '6289330L36.1',
                         '6290220L42', '6367530L42', '649980L61', '6653560L42',
                         '6901560L42', '7021590L42.1', '7299540L31',
                         '758950L42', '7633420L42.1', '7639950L36',
                         '7640190L42.2', '7642660L42.1', '7659820L67',
                         '7662120L42.1', '7723430L42', '7723430L42.1',
                         '773130L42.1', '7740420L42', '7821280L42',
                         '7855190L42.1', '7856340L42.8', '7867800L67',
                         '7937370L23', '7938020L60', '7939430L42',
                         '7947500L36.1', '7975890L61', '7975890L61',
                         '8016960L42', '8020090L66', '8036270L42',
                         '8044190L61', '8054650L42.1', '8070650L36',
                         '8070650L36', '8070650L36', '8070650L36',
                         '8070650L36', '8070650L36', '8070650L36',
                         '8108213L61', '8108383L42', '8108591L36',
                         '8108591L36', '8108676L42', '8109463L36',
                         '8109663L61', '8109663L61', '8109689L42',
                         '8110008L36', '8110272L42', '8110299L61',
                         '8110299L61', '8110412L61', '8110448L66',
                         '8110599L42', '8110875L36', '8111063L23',
                         '8111166L36', '8111433L42.1', '8111433L66',
                         '8111502L42.1', '8112011L67.1', '8112643L42.2',
                         '8112643L42.3', '8113047L40.1', '8113441L36',
                         '8113631L42', '8113675L42.1', '8113846L36',
                         '8113916L31.1', '8114816L42.1', '8115372L42',
                         '8115749L42.1', '8115831L42', '8115831L42.1',
                         '8115831L42.1', '8115831L42.3', '8116472L66',
                         '8116536L42.1', '8117228L42.1', '8117689L66',
                         '8117951L62', '8117951L62', '8118246L61',
                         '8118291L15', '8118364L36', '8118702L61',
                         '8118836L36', '8118903L61', '8118903L61',
                         '8118903L61', '8119613L42', '8120131L23',
                         '8120433L42', '8120638L67', '8121336L36',
                         '8121336L60', '8121336L60', '8121747L42.2',
                         '8121975L42.1', '8122139L42', '8122658L36',
                         '8122902L42', '8123066L67', '8123264L40',
                         '8123316L42.1', '8123403L67', '8123462L42.2',
                         '8123730L36.2', '8123730L42.2', '8123881L42.3',
                         '8123937L36', '8124192L42', '8124235L62',
                         '8124281L61', '8124324L23', '8124612L61',
                         '8124748L66', '8125221L31', '8125337L67',
                         '8125337L67', '8125472L42', '8125472L42',
                         '8125947L42.1', '8125965L42.1', '8126404L42.2',
                         '8126950L67', '8126962L42.1', '8126962L42.1',
                         '8127221L42', '8127286L42', '8127693L66',
                         '8127755L42', '8127774L61', '8127843L61.1',
                         '8127992L36.1', '8128067L36', '8128104L42',
                         '8128506L60', '8128526L42', '8128597L61.1',
                         '8128810L61', '8128866L36', '8129715L36',
                         '8129733L31', '8129783L15', '8130017L62',
                         '8130247L67', '8130370L42.1', '8130370L42.1',
                         '8130386L42.1', '8130459L40.1', '8130539L42',
                         '8130559L42', '8130858L23.1', '8130920L36',
                         '8130991L61', '8131043L61', '8131053L41',
                         '8131068L31', '8131092L36', '8131240L62',
                         '8131240L62', '8131255L36', '8131448L42.1',
                         '8131597L42.3', '8131719L67', '8131719L67',
                         '8132039L67', '8132039L67', '8132158L42',
                         '8132198L42.2', '8132232L42', '8132450L42.2',
                         '8132736L36', '8132832L42.2', '8132926L42',
                         '8132926L42', '8133337L42', '8133489L42.1',
                         '8133793L36', '8133931L42.2', '8134177L61',
                         '8134242L42', '8134312L42', '8134782L42',
                         '8134805L42.4', '8134814L42', '8135208L67',
                         '8135208L67', '8135348L42.2', '8135456L23',
                         '8135480L42', '8135739L36', '8135830L42',
                         '8135830L42', '8136054L42', '8136286L40.1',
                         '8136317L37', '8136376L42.1', '8136556L42.2',
                         '8136902L36', '8137001L42.1', '8137020L31',
                         '8137294L40.1', '8137578L42', '8137916L60',
                         '8137916L60', '8137928L62.1', '8138258L36',
                         '8138482L42.1', '8138558L36.1', '8138706L66',
                         '8139203L61.1', '8139368L62', '8139368L62',
                         '8139417L36', '8139432L42.1', '8139432L42.2',
                         '8139482L42', '8139494L41', '8139974L36',
                         '8140457L42.1', '8140504L42', '8140557L66.2',
                         '8140567L42', '8140656L66', '8140675L36',
                         '8140873L42', '8140879L42.1', '8140922L42.1',
                         '8140989L42', '8141048L42', '8141048L42.1',
                         '8141505L36', '8141807L61', '8141886L36',
                         '8142183L42', '8142249L42', '8142249L42.1',
                         '8142312L42', '8142357L42.2', '8142374L42.1',
                         '8142687L36.1', '8142722L40', '8142722L40',
                         '8142722L40', '8142722L40', '8142854L42.2',
                         '8143222L42.3', '8143230L42', '8143230L42',
                         '8143230L42', '8143285L42.2', '8143288L42.1',
                         '8143406L66.1', '8143686L66.2', '8144116L61',
                         '8144291L41', '8144310L42.2', '8144333L42',
                         '8144391L42', '8144589L36', '8144637L42',
                         '8144637L42.1', '8144788L36', '8144791L40',
                         '8145557L42', '8145741L67', '8145999L61',
                         '8145999L61', '8146119L42.1', '8146323L36',
                         '8146430L42.3', '8146516L31', '8146847L42',
                         '8147387L31', '8147397L42', '8147612L42',
                         '8147635L42', '8147640L67', '8147712L42.2',
                         '8148421L42', '8148445L38', '8148834L36',
                         '8148849L42', '8149018L67.1', '8149057L62',
                         '8149059L61.1', '8149246L61.1', '8149290L36.1',
                         '8149304L62', '8149343L42', '8149802L42.2',
                         '8150004L36', '8150018L36', '8150415L42',
                         '8150661L42', '8150868L42', '8150868L67',
                         '8150868L67', '8150951L36', '8150951L36',
                         '8150982L42', '8151339L42.2', '8151339L42.2',
                         '8151441L42.3', '8152048L36', '8152055L42',
                         '8152055L42.1', '8152273L42.1', '8152297L42.2',
                         '8152297L42.2', '8152467L42.1', '8152494L42',
                         '8152732L42.1', '8152755L42.1', '8153085L42.1',
                         '8153237L42.1', '8153575L31.1', '8153614L31',
                         '8153764L42', '8154379L42', '8154654L31',
                         '8154671L42', '8154882L36.1', '8154894L67.1',
                         '8155158L42', '8155213L42', '8155266L42',
                         '8155405L67', '8155405L67', '8155405L67',
                         '8155609L42', '8155799L42', '8155846L67',
                         '8156093L42', '8156511L36.1', '8156550L42',
                         '8156622L36', '8156689L42', '8156949L61',
                         '8157386L36', '8157386L36', '8157606L36',
                         '8157794L42', '8157800L36.1', '8157828L61.1',
                         '8157927L77', '8157927L77', '8158007L67.1',
                         '8158072L42.1', '8158134L62', '8158190L61',
                         '8158190L61', '8158309L36', '8158658L36',
                         '8158705L42', '8159068L38', '8159257L42',
                         '8159308L36', '8159502L31', '8159516L36',
                         '8159687L61', '8159702L42.1', '8159819L16',
                         '8159825L36', '8159849L36', '8159862L23',
                         '8159922L36', '8160208L36', '8160208L36',
                         '8160208L36', '8160208L36', '8160208L36',
                         '8160208L36', '8160208L36', '8160208L36',
                         '8160208L36', '8160280L42', '8160280L42',
                         '8160301L61', '8160368L36', '8160371L36.1',
                         '8160403L42', '8160464L42.1', '8160659L36',
                         '8160659L36', '8160659L36', '8160659L36',
                         '8160659L36', '8160762L42', '8160796L36',
                         '8160900L36.1', '8160931L38', '8161053L36',
                         '8161059L36', '8161076L42', '8161083L36',
                         '8161083L36', '8161083L36', '8161085L36.1',
                         '8161204L36', '8161227L36', '8161227L36',
                         '8161227L36', '8161365L36', '8161447L36',
                         '8161528L36', '8161555L42', '8161676L36',
                         '8161676L36', '8161676L36', '8161676L36',
                         '8161676L36', '8161841L36', '8161866L36',
                         '8161970L36', '8162192L42', '8162201L42',
                         '8162265L36', '8162265L36', '8162265L36',
                         '8162265L36', '8162339L42.2', '8162366L67',
                         '8162386L42.1', '8162400L61', '8162468L36',
                         '8162469L36.1', '8162469L36.1', '8162537L61',
                         '8162554L36', '8162704L36', '8162736L36',
                         '8162736L36', '8162736L36', '8162770L42',
                         '8162851L36', '8162863L31', '8162974L36',
                         '8162976L36', '8163090L36', '8163107L42',
                         '8163232L36', '8163232L36', '8163376L36.1',
                         '8163420L36', '8163537L36', '8163537L36',
                         '8163537L36', '8163538L38', '8163561L36',
                         '8163563L42', '8163588L36', '8163588L36',
                         '8163615L36', '8163657L36', '8163657L36',
                         '8163735L36', '8163744L67', '8163786L36',
                         '8163852L42', '8163856L36', '8163912L36',
                         '8163994L36', '8164044L31', '8164140L36',
                         '8164168L36', '8164226L42', '8164294L32',
                         '8164294L32', '8164333L36', '8164336L36',
                         '8164350L36', '8164468L36', '8164475L36',
                         '8164475L36', '8164475L36', '8164632L31',
                         '8164632L31', '8164652L36', '8164681L36',
                         '8164773L36.2', '8164803L67', '8164819L42',
                         '8164844L36', '8164913L36', '8164915L36',
                         '8164915L36', '8164956L36', '8165057L36',
                         '8165071L36', '8165090L36', '8165090L36',
                         '8165091L36', '8165093L42', '8165159L36',
                         '8165271L42.3', '8165330L36.1', '8165342L36',
                         '8165433L36', '8165442L42.1', '8165501L36',
                         '8165547L31', '8165722L31', '8165733L42',
                         '8165852L62.1', '8165916L42', '8165942L36.1',
                         '8165945L31', '8165966L36', '8166002L36',
                         '8166087L31', '8166124L36', '8166216L42',
                         '8166259L42', '8166278L67', '8166332L36',
                         '8166399L42.1', '8166401L31.1', '8166478L36',
                         '8166479L42', '8166566L36', '8166591L36',
                         '8166593L36', '8166657L31', '8166828L36',
                         '8166974L36', '8167105L61', '8167111L31',
                         '8167420L61', '8167460L38.1', '8167475L23.1',
                         '8167477L36', '8167630L67', '8167677L42',
                         '8167695L36', '8167707L42', '8167735L36',
                         '8167831L67.2', '8167831L67.2', '8167833L36',
                         '8167883L67', '8167931L36', '8168193L36',
                         '8168201L36.1', '8168284L36', '8168285L36',
                         '8168293L31', '8168293L31', '8168345L38.2',
                         '8168429L38', '8168522L36', '8168585L36',
                         '8168718L36', '8168730L42', '8168757L36',
                         '8168787L36.1', '8168823L42', '8168972L36',
                         '8168985L36', '8169045L67', '8169100L36',
                         '8169310L38', '8169327L42', '8169327L42',
                         '8169327L42', '8169648L36', '8169704L42',
                         '8169868L42', '8170027L36', '8170035L61',
                         '8170119L36', '8170187L36', '8170195L36',
                         '8170406L36', '8170641L36', '8170839L42',
                         '8170999L36', '8171148L36', '8171292L42',
                         '8171292L42.1', '8171429L36', '8171626L36',
                         '8171718L42', '8171796L42', '8171812L42',
                         '8171976L42', '8171987L42', '8171989L36',
                         '8171989L36', '8171990L36', '8171993L38',
                         '8172006L38', '8172009L38', '8172020L36',
                         '8172022L31', '8172024L42.1', '8172029L42',
                         '8172038L42', '8172068L36', '8172081L38',
                         '8172105L36', '8172196L42', '8172235L36',
                         '8172238L38', '8172239L38', '8172259L38',
                         '8172275L42', '8172297L36', '8172356L42.1',
                         '8172368L42', '8172389L42', '8172444L42',
                         '8172454L42', '8172458L42', '8172655L36',
                         '8173322L36', '8173643L36', '8173699L42',
                         '8173720L38', '8173969L36', '8174143L38',
                         '8174143L38', '8174143L38.1', '8174143L38.1',
                         '8174212L36', '8174421L36', '8174462L36',
                         '8174509L42', '8174514L61', '8174516L61',
                         '8174547L38', '8174567L31', '8174580L36',
                         '8174581L36', '8174582L36', '8174600L36',
                         '8174614L38', '8174655L36', '8174725L42',
                         '8174777L42', '8174875L36', '8174952L38',
                         '8175096L38', '8175299L32', '8175309L36',
                         '8175357L61', '8175474L36', '8175661L36',
                         '8175802L36', '8175905L36', '8176042L36',
                         '8176160L23', '8176553L36', '8176678L38',
                         '8176715L36', '8178236L31', '8178238L36',
                         '8178284L36', '8179904L61', '8180249L38',
                         '8187575L67', '8187575L67', '8188682L42',
                         '8190878L38', '8191162L36', '8191210L31',
                         '8191237L32', '821490L42.2', '827350L42', '857610L42',
                         '882780L65', '981940L61', '996300L61' )


SELECT CC.CODE_TX,  R.* FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL_CODE CC ON R.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX LIKE '%-OT'
ORDER BY CC.CODE_TX ASC 


SELECT CC.CODE_TX, COUNT(CC.CODE_TX)   FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL_CODE CC ON R.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX LIKE '%-OT'
GROUP BY  CC.CODE_TX


SELECT CC.CODE_TX, COUNT(CC.CODE_TX)   FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL C ON R.ID = C.ID 
JOIN dbo.COLLATERAL_CODE CC ON R.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX LIKE '%-A' OR cc.CODE_TX LIKE '%-OT'
GROUP BY  CC.CODE_TX


SELECT CC.CODE_TX, COUNT(CC.CODE_TX)   FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL C ON R.ID = C.ID 
JOIN dbo.COLLATERAL_CODE CC ON C.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX LIKE '%-A' OR cc.CODE_TX LIKE '%-OT'
GROUP BY  CC.CODE_TX

SELECT CC.CODE_TX,  R.* FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL_CODE CC ON R.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX = 'VEH-OT'
ORDER BY CC.CODE_TX ASC 

SELECT * FROM dbo.COLLATERAL_CODE
WHERE CODE_TX = 'JET SKI'
--525


UPDATE dbo.COLLATERAL
SET COLLATERAL_CODE_ID = '16'
--SELECT * FROM dbo.COLLATERAL
WHERE COLLATERAL.ID IN (SELECT R.ID FROM UniTracHDStorage..INC0300079_R R
JOIN dbo.COLLATERAL_CODE CC ON R.COLLATERAL_CODE_ID = CC.ID 
WHERE CC.CODE_TX = 'JETSKI -A')
