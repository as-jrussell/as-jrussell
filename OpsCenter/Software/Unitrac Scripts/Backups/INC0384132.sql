use UniTrac


--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT DISTINCT L.NUMBER_TX, P.FIELD_PROTECTION_XML.value('(/FP/Field/@name) [1]', 'varchar (max)') [Retain], O.FIRST_NAME_TX, O.LAST_NAME_TX, OA.LINE_1_TX, OA.LINE_2_TX, OA.CITY_TX, OA.STATE_PROV_TX, OA.POSTAL_CODE_TX FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON P.ADDRESS_ID = OA.ID
INNER JOIN dbo.LENDER LL ON LL.ID = L.LENDER_ID
WHERE  L.LENDER_ID = '180' 
and P.FIELD_PROTECTION_XML.value('(/FP/Field/@name) [1]', 'varchar (max)') like 'Address%'
