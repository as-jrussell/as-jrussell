-------------- Check Work Items Before Update (To Verify Work Item Definition and Status)
-------------- Work Item ID Number(s) should be provided on HDT
----REPLACE XXXXXXX WITH THE THE WI ID


SELECT CONTENT_XML.value('(/Content/Lender/Code)[1]', 'varchar (50)') Lender, *
FROM    UniTrac..WORK_ITEM
WHERE   ID IN ( 28231952, 28231952   )

SELECT *
from lender
WHERE code_tx = '7545'

		Select	START_DT,
			END_DT
	From PROCESS_LOG where ID = 28975060


SELECT REPORTED_DT,*
FROM dbo.ESCROW
WHERE id IN (634076,634106,634066,634121,633879,634122,634014,634078,630901,634041,634088,634097,634071,634110,634102,633933,634087,634064,634090,634113,630813,634084,631228,632309,634125,631222,634045,631217,632304,634100,631232,633962,630873,634062,634051,634120,631225,634112,633990,634054,631220,634069,634036,634094,634095,634049,634098,634118,634080,634068,634052,634086,632254,634092,631230,633983,633944,634043,634073,632570,634059,633934,632328,632324,634075,634117,634126,634044,634081,632319,634077,634567,632249,632685,631236)
--2015-12-10 13:53:04.9330000

UPDATE dbo.ESCROW
SET REPORTED_DT = '2015-12-10 13:53:04.9330000'
WHERE id IN (634076,634106,634066,634121,633879,634122,634014,634078,630901,634041,634088,634097,634071,634110,634102,633933,634087,634064,634090,634113,630813,634084,631228,632309,634125,631222,634045,631217,632304,634100,631232,633962,630873,634062,634051,634120,631225,634112,633990,634054,631220,634069,634036,634094,634095,634049,634098,634118,634080,634068,634052,634086,632254,634092,631230,633983,633944,634043,634073,632570,634059,633934,632328,632324,634075,634117,634126,634044,634081,632319,634077,634567,632249,632685,631236)


SELECT * FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (28975060) AND RELATE_TYPE_CD LIKE '%reporthistory'
AND RELATE_ID = '8498165'

--Loan Screen Information - LOAN/COLLATERAL/PROPERTY/OWNER/REQUIRED COVERAGE
SELECT C.* FROM LOAN L
INNER JOIN COLLATERAL C ON L.ID = C.LOAN_ID
INNER JOIN PROPERTY P ON C.PROPERTY_ID = P.ID
INNER JOIN REQUIRED_COVERAGE RC ON P.ID = RC.PROPERTY_ID
INNER JOIN OWNER_LOAN_RELATE OL ON L.ID = OL.LOAN_ID
INNER JOIN OWNER O ON OL.OWNER_ID = O.ID
INNER JOIN OWNER_ADDRESS OA ON O.ADDRESS_ID = OA.ID
WHERE L.ID = '93122283'

SELECT *
FROM dbo.PROCESS_LOG_ITEM
WHERE relate_id = 8517135 AND RELATE_TYPE_CD LIKE '%reporthistory'

--28975060
SELECT *
from WORK_ITEM_PROCESS_LOG_ITEM_RELATE WIPLIR 
Join PROCESS_LOG_ITEM PLI ON WIPLIR.PROCESS_LOG_ITEM_ID = PLI.ID and PLI.RELATE_TYPE_CD = 'Allied.UniTrac.Escrow' and PLI.Purge_DT IS NULL
WHERE WORK_ITEM_ID = 28231952

SELECT * FROM dbo.REPORT_HISTORY
WHERE ID IN (SELECT RELATE_ID FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (28975060) AND RELATE_TYPE_CD LIKE '%reporthistory')
AND RECORD_COUNT_NO = '0'


select ID as REPORT_ID, rh.REPORT_DATA_XML.value( '(/ReportData/Report/Title/@value)[1]', 'varchar(500)' ) as TITLE
into #t
from REPORT_HISTORY rh
WHERE ID IN (SELECT RELATE_ID FROM dbo.PROCESS_LOG_ITEM
WHERE PROCESS_LOG_ID IN (28975060) AND RELATE_TYPE_CD LIKE '%reporthistory')
AND RECORD_COUNT_NO = '0'


SELECT * FROM #t
WHERE TITLE = 'Escrow Premium Due Report - Premium Due'

SELECT * FROM dbo.REPORT_HISTORY
WHERE ID IN (8498165,
8498175,
8506860,
8506870,
8507114,
8507124,
8515312,
8515322)


SELECT * FROM dbo.REPORT_HISTORY
WHERE REPORT_ID = '46' 
AND REPORT_DATA_XML.value( '(/ReportData/Report/Title/@value)[1]', 'varchar(500)' ) = 'Escrow Premium Due Report - Premium Due'
AND STATUS_CD = 'COMP' AND CAST(UPDATE_DT AS DATE) = CAST(GETDATE() AS DATE)

SELECT * FROM dbo.REPORT_CONFIG
WHERE ID = '724'


SELECT * FROM dbo.REPORT



WHERE id = '46'
EXEC dbo.Report_Escrow @LenderCode = N'7545', -- nvarchar(10)
--    @Branch = N'', -- nvarchar(max)
--   @Division = N'', -- nvarchar(10)
--    @Coverage = N'', -- nvarchar(100)
--    @InsCompany = N'', -- nvarchar(100)
    @ReportType = N'ESCPRMDUE', -- nvarchar(50)
    @GroupByCode = N'B/D/C', -- nvarchar(50)
    @SortByCode = N'BorrowerName'--, -- nvarchar(50)
--    @FilterByCode = N'', -- nvarchar(50)
--    @SpecificReport = '', -- varchar(50)
--    @Report_History_ID = 0 -- bigint
