USE [master]


/****** Object:  Database [PRL_AIRACADEMY_1555_PROD]    Script Date: 3/1/2021 9:47:50 PM ******/

IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD')
BEGIN

CREATE DATABASE [PRL_AIRACADEMY_1555_PROD]
 CONTAINMENT = NONE
 END
ELSE
BEGIN 
	PRINT 'Database Created already' 
END

IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
	EXEC [PRL_AIRACADEMY_1555_PROD].[dbo].[sp_fulltext_database] @action = 'enable'
end
ELSE
BEGIN 
	PRINT 'WARNING: Did not enable or already enabled' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_ansi_null_default_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ANSI_NULL_DEFAULT ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_ansi_nulls_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ANSI_NULLS ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_ansi_padding_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ANSI_PADDING ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_ansi_warnings_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ANSI_WARNINGS ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_arithabort_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ARITHABORT ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_auto_shrink_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET AUTO_SHRINK OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_auto_update_stats_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET AUTO_UPDATE_STATISTICS ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_cursor_close_on_commit_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET CURSOR_CLOSE_ON_COMMIT OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_local_cursor_default = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET CURSOR_DEFAULT  LOCAL 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_concat_null_yields_null_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET CONCAT_NULL_YIELDS_NULL ON 
END 
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_numeric_roundabort_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET NUMERIC_ROUNDABORT OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_quoted_identifier_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET QUOTED_IDENTIFIER ON 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_recursive_triggers_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET RECURSIVE_TRIGGERS OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_auto_update_stats_async_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_trustworthy_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET TRUSTWORTHY OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_read_committed_snapshot_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ALLOW_SNAPSHOT_ISOLATION OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_parameterization_forced = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET PARAMETERIZATION SIMPLE 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_read_committed_snapshot_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET READ_COMMITTED_SNAPSHOT OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_db_chaining_on = 0)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET DB_CHAINING OFF 
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_encrypted = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET ENCRYPTION ON
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_query_store_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET QUERY_STORE = ON
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'PRL_AIRACADEMY_1555_PROD' and is_query_store_on = 1)
BEGIN
ALTER DATABASE [PRL_AIRACADEMY_1555_PROD] SET QUERY_STORE (OPERATION_MODE = READ_WRITE, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 30), DATA_FLUSH_INTERVAL_SECONDS = 900, INTERVAL_LENGTH_MINUTES = 60, MAX_STORAGE_SIZE_MB = 100, QUERY_CAPTURE_MODE = AUTO, SIZE_BASED_CLEANUP_MODE = AUTO, MAX_PLANS_PER_QUERY = 200, WAIT_STATS_CAPTURE_MODE = ON)
END
ELSE
BEGIN 
	PRINT 'WARNING: Check settings' 
END

--BEGIN
--	EXEC DBA.[rfpl].[CreateRFPLSQLUser] @DryRun = 0 --Refresh all permissions

--END